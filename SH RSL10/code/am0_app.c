/**
 ****************************************************************************************
 *
 * @file am0_APP.c
 *
 * @brief Audio Mode 0 Application example
 *
 * Copyright (C) RivieraWaves 2009-2016
 *
 ****************************************************************************************
 */


/**
 ****************************************************************************************
 * @addtogroup AM0_APP
 * @{
 ****************************************************************************************
 */

/*
 * INCLUDE FILES
 ****************************************************************************************
 */

#include "rwip_config.h"     // SW configuration
//
#ifdef BLE_APP_AM0
#include "app.h"             // Application Definitions
#include "am0_app.h"         // AM0 Application Definitions
#include <co_bt.h>
#include <prf_types.h>       // Profile common types definition
#include "arch.h"            // Platform Definitions
#include <prf.h>
#include <am0_task.h>
//#include <am0_has_task.h>



extern void app_display_update_audio_info(uint8_t state, uint8_t volume);

/*
 * DEFINES
 ****************************************************************************************
 */

////////////////////////////////////////////////////////////////////////////
//Dzung: moved to am0_app.h

///// Advertising minimum interval - 40ms (64*0.625ms)
//#define AM0_ADV_INT_MIN                 (64)
///// Advertising maximum interval - 40ms (64*0.625ms)
//#define AM0_ADV_INT_MAX                 (64)
//
//
//
///// Maximal length of the Device Name value
//#define AM0_DEVICE_NAME_MAX_LEN         (22)
//#define AM0_IDENTIFIER_MAX_LEN          (20)
///// Default Device Name if no value can be found in NVDS
//#define AM0_DFLT_DEVICE_NAME            ("RW-BLE Left Ear")
///// Default program name
//#define AM0_APP_PROG_DFLT_NAME          "Default"
//
//
///// certificate information
//#define AM0_NVDS_KEY_MAX_LEN            (64*3)
//
//#define AM0_CERT_DATA_MAX_LEN           (1024)
//#define AM0_CERT_PRIV_KEY_MAX_LEN       (64*5)
//
///// Number of available programs
//#define AM0_NB_PROGS                    (2)
//
//#define HAS_HEARING_AID_SERVICE_UUID    "\x92\x15\x37\x84\xE8\xCC\x2C\x86\x31\x44\x4A\xC7\xBD\xF4\x74\x7D"
//
//
//#define AM0_APP_DFLT_ID          "RW-BLE LEFT"
//#define AM0_APP_DFLT_OTHER_ID    "RW-BLE RIGHT"

//
///*
// * TYPE DEFINITIONS
// ****************************************************************************************
// */
/// audio mode 0 NVDS
//enum am0_app_nvds_tag
//{
//    /// Hearing aid identifier
//    NVDS_TAG_AM0_ID               = NVDS_TAG_AM0_FIRST,
//    /// Other Hearing aid identifier
//    NVDS_TAG_AM0_OTHER_ID,
//    /// private key partitioning
//    NVDS_TAG_AM0_PRIV_KEY_FIRST,
//    NVDS_TAG_AM0_PRIV_KEY_LAST    = NVDS_TAG_AM0_PRIV_KEY_FIRST+1,
//    /// certificate partitioning
//    NVDS_TAG_AM0_CERT_FIRST,
//    NVDS_TAG_AM0_CERT_LAST        = NVDS_TAG_AM0_CERT_FIRST    +5,
//
//    NVDS_TAG_AM0_MAX,
//
//    /// Parameter length
//    NVDS_LEN_AM0_ID       = AM0_IDENTIFIER_MAX_LEN,
//    NVDS_LEN_AM0_OTHER_ID = AM0_IDENTIFIER_MAX_LEN,
//    NVDS_LEN_AM0_CERT     = AM0_NVDS_KEY_MAX_LEN,
//    NVDS_LEN_AM0_PRIV_KEY = AM0_NVDS_KEY_MAX_LEN,
//};
//
//
//
///// Audio program information
//struct am0_app_prog
//{
//    /// Program name
//    uint8_t name_len;
//    uint8_t name[AM0_PROG_NAME_MAX_LEN];
//    /// Program category
//    uint8_t category;
//};
//
//
///// Audio Mode 0 Application environment
//struct am0_app_env_tag
//{
//    // ------------------- Audio Mode 0 ---------------
//    #if (DISPLAY_SUPPORT)
//    uint8_t state;
//    uint8_t volume;
//    #endif // (DISPLAY_SUPPORT)
//
//    // ------------------- Hearing Aid Service ---------------
//    uint16_t prf_task;
//
//    /// Hearing Aid identifier
//    uint8_t id_len;
//    uint8_t id[AM0_IDENTIFIER_MAX_LEN];
//    /// Other Hearing Aid identifier
//    uint8_t other_id_len;
//    uint8_t other_id[AM0_IDENTIFIER_MAX_LEN];
//
//    /// Certificate data length
//    uint16_t cert_data_len;
//    /// Certificate data payload
//    uint8_t  cert_data[AM0_CERT_DATA_MAX_LEN];
//    /// Private key length
//    uint16_t cert_priv_key_len;
//    /// Private key
//    uint8_t  cert_priv_key[AM0_CERT_PRIV_KEY_MAX_LEN];
//
//    /// Current active program identifier
//    uint8_t active_prog_id;
//
//    uint8_t selected_prog_id;
//    /// programs info
//    struct am0_app_prog progs[AM0_NB_PROGS];
//};

////////////////////////////////////////////////////////////////////////////


/*
 * MACROS
 ****************************************************************************************
 */


/*
 * GLOBAL VARIABLE DEFINITIONS
 ****************************************************************************************
 */
/// audio mode 0 application environment variable
struct am0_app_env_tag am0_app_env;

// Dzung:
/* The application requires to have 3 elements of the certificate:
 *  - PART A and B of public key: CERTIF_PART_A_VAL, CERTIF_PART_B_VAL are used by
 *  Apple device to check if certificate is valid and for challenge verification
 *  - The private key (never sent over the air):  used to answer (using RSA) to the
 *  challenge request (challenge resp = RSA(challenge_req, Private_key))
 * When you receive a AM0_HAS_GET_AUTH_INFO_REQ_IND (which request certificate part A, B
 * or private key), answer with expected value using AM0_HAS_GET_AUTH_INFO_CFM message
 * Notes: We are using the certificate example provided by Apple on the MFI web site
 */
// The sample certificate data from MFI portal (910 bytes = 512 + 398)
//  - CERTIF_PART_A_VAL: the first 512 bytes
//  - CERTIF_PART_B_VAL: the remaining of certificate (from byte 512 to the last byte)

////////////////////////////////////////////////////////////////////////////////////////
// from CEVA (cert_id = 0): A(512 bytes) + B(398 bytes) = 910 bytes; priv(320 bytes)
// ORIGNAL
//const uint8_t AM0_CERT_DATA[] = {
//		0x00, 0x31, 0x00, 0xA1, 0xEC, 0x3C, 0x29, 0x52, 0x49, 0x8C,
//		0xA3, 0x1B, 0x67, 0x67, 0x89, 0xD5, 0x90, 0xF5, 0xBA, 0x12,
//		0x70, 0x09, 0x6F, 0x24, 0xD9, 0x87, 0x8D, 0x57, 0xE2, 0x81,
//		0x41, 0x94, 0xEB, 0x1E, 0xF0, 0x87, 0x3F, 0x45, 0x7F, 0x82,
//		0x21, 0x12, 0x06, 0xD2, 0x73, 0x80, 0xB1, 0xC4, 0xEC, 0xA8,
//		0xA7, 0x39, 0x68, 0xDB, 0xCD, 0x7D, 0x7B, 0xCF, 0xD0, 0x71,
//		0x46, 0x53, 0xBE, 0x64, 0x87, 0x6C, 0x2D, 0x0C, 0xCE, 0x59,
//		0x20, 0xF6, 0xA6, 0x39, 0x31, 0x7A, 0x9B, 0x24, 0xEB, 0x11,
//		0xC9, 0xA6, 0x84, 0xA9, 0x8F, 0xF8, 0xD8, 0x06, 0x2A, 0xDE,
//		0x74, 0x95, 0xC3, 0x41, 0x7C, 0x18, 0xCE, 0x78, 0x06, 0xAF,
//		0xD6, 0x3D, 0xEF, 0x8F, 0x41, 0xB3, 0x90, 0xBF, 0x08, 0x83,
//		0x03, 0x95, 0xD9, 0x9D, 0xF2, 0x8F, 0x58, 0xE5, 0xC7, 0x0B,
//		0x30, 0xE0, 0x6E, 0x08, 0x40, 0x97, 0xBF, 0xA4, 0x2F, 0x91,
//		0x92, 0x76, 0x2C, 0x9E, 0xCB, 0x48, 0xD9, 0xAE, 0x5F, 0xD7,
//		0xC2, 0xFA, 0x1F, 0xD1, 0x41, 0xC3, 0xBA, 0x7F, 0x87, 0x0F,
//		0xB5, 0xEC, 0x03, 0xD6, 0x26, 0xAF, 0x2D, 0x92, 0xA4, 0xCA,
//		0x87, 0xA9, 0x0C, 0x66, 0x8C, 0xD8, 0x96, 0x63, 0xFD, 0x7B,
//		0xC3, 0xEF, 0xE9, 0x92, 0x07, 0x80, 0x26, 0xBC, 0xFC, 0xA8,
//		0x53, 0x73, 0xD0, 0x88, 0x20, 0x09, 0x2F, 0x1B, 0x0F, 0x8D,
//		0xF6, 0xDB, 0xDF, 0xED, 0xC5, 0x1A, 0xAC, 0xDB, 0x57, 0xA3,
//		0x8C, 0x6D, 0xD7, 0xF5, 0x35, 0xC0, 0x09, 0xCF, 0x6C, 0x97,
//		0xB8, 0xCC, 0x65, 0x7A, 0xFB, 0x7E, 0x77, 0x10, 0x15, 0x84,
//		0x93, 0xF1, 0xB8, 0x21, 0x5C, 0x65, 0x6A, 0x69, 0x45, 0xAE,
//		0x6A, 0xA8, 0x03, 0xB7, 0x4D, 0xB6, 0xA9, 0x55, 0xBF, 0xA0,
//		0x71, 0x71, 0xE3, 0x0D, 0xB2, 0x58, 0x30, 0xFA, 0x08, 0x14,
//		0x2E, 0xF1, 0xF1, 0xF5, 0x28, 0x56, 0x63, 0xD1, 0xB4, 0x9F,
//		0x00, 0x01, 0x01, 0x82, 0x03, 0x00, 0x05, 0x05, 0x01, 0x01,
//		0x0D, 0xF7, 0x86, 0x48, 0x86, 0x2A, 0x09, 0x06, 0x0D, 0x30,
//		0x04, 0xC7, 0x8E, 0x9D, 0x40, 0xEE, 0xC9, 0x61, 0x2B, 0x00,
//		0x18, 0xAB, 0x96, 0x19, 0xF5, 0x9A, 0x43, 0x1A, 0x4B, 0xFF,
//		0x14, 0x80, 0x16, 0x30, 0x18, 0x04, 0x23, 0x1D, 0x55, 0x03,
//		0x06, 0x1F, 0x30, 0xBA, 0x16, 0x7F, 0x89, 0x31, 0xE6, 0x64,
//		0x22, 0xEE, 0x4B, 0xC0, 0xA5, 0xF2, 0xF2, 0x0B, 0xFF, 0xE1,
//		0xA3, 0x99, 0x51, 0x14, 0x04, 0x16, 0x04, 0x0E, 0x1D, 0x55,
//		0x03, 0x06, 0x1D, 0x30, 0x00, 0x30, 0x02, 0x04, 0xFF, 0x01,
//		0x01, 0x13, 0x1D, 0x55, 0x03, 0x06, 0x0C, 0x30, 0xB8, 0x03,
//		0x02, 0x03, 0x04, 0x04, 0xFF, 0x01, 0x01, 0x0F, 0x1D, 0x55,
//		0x03, 0x06, 0x0E, 0x30, 0x5E, 0x30, 0x60, 0xA3, 0x01, 0x00,
//		0x01, 0x03, 0x02, 0x8F, 0x7B, 0xD5, 0x0B, 0xC8, 0x60, 0xB1,
//		0x5C, 0x9F, 0x5C, 0xCB, 0xA6, 0xF8, 0x6B, 0xD9, 0x8A, 0xBD,
//		0x9D, 0xBD, 0xB9, 0x6D, 0xB2, 0xD7, 0x3F, 0xA8, 0xDB, 0xD3,
//		0x33, 0xB9, 0x8B, 0x4B, 0xD8, 0x86, 0xDF, 0x9E, 0xDD, 0xAD,
//		0x4A, 0x7D, 0x37, 0x4E, 0x90, 0x9C, 0xE7, 0x26, 0x42, 0x96,
//		0xEE, 0xE9, 0x4D, 0xED, 0xB6, 0x6D, 0x28, 0x09, 0xD8, 0x10,
//		0x67, 0xB3, 0xD5, 0x09, 0x33, 0x9F, 0x88, 0x56, 0x1F, 0xFF,
//		0xDF, 0x7F, 0xD9, 0x41, 0x8E, 0x3A, 0x5B, 0x14, 0x83, 0x32,
//		0xCF, 0xB2, 0xC4, 0x49, 0xF7, 0x2C, 0x69, 0x37, 0x9D, 0x44,
//		0x63, 0x54, 0xD5, 0x6A, 0x91, 0x65, 0x45, 0x2B, 0x1B, 0xCD,
//		0x11, 0x1C, 0xCF, 0x10, 0x19, 0x6D, 0x83, 0x55, 0x55, 0x3E,
//		0x31, 0x81, 0x05, 0xB7, 0xC3, 0x48, 0xA3, 0x95, 0xE2, 0x64,
//		0x43, 0x53, 0xD2, 0x69, 0x3C, 0x36, 0x9F, 0x93, 0xA6, 0x57,
//		0xDA, 0x00,
//		0x81, 0x81, 0x02, 0x89, 0x81, 0x30, 0x00, 0x8D, 0x81, 0x03,
//		0x00, 0x05, 0x01, 0x01, 0x01, 0x0D, 0xF7, 0x86, 0x48, 0x86,
//		0x2A, 0x09, 0x06, 0x0D, 0x30, 0x9F, 0x81, 0x30, 0x31, 0x30,
//		0x30, 0x30, 0x30, 0x30, 0x41, 0x41, 0x33, 0x30, 0x30, 0x30,
//		0x41, 0x41, 0x42, 0x30, 0x41, 0x41, 0x38, 0x30, 0x35, 0x30,
//		0x34, 0x31, 0x41, 0x41, 0x33, 0x33, 0x33, 0x33, 0x5F, 0x41,
//		0x50, 0x49, 0x22, 0x14, 0x03, 0x04, 0x55, 0x03, 0x06, 0x29,
//		0x30, 0x2B, 0x31, 0x73, 0x65, 0x69, 0x72, 0x6F, 0x73, 0x73,
//		0x65, 0x63, 0x63, 0x41, 0x20, 0x64, 0x6F, 0x50, 0x69, 0x20,
//		0x65, 0x6C, 0x70, 0x70, 0x41, 0x16, 0x13, 0x0B, 0x04, 0x55,
//		0x03, 0x06, 0x1D, 0x30, 0x1F, 0x31, 0x2E, 0x63, 0x6E, 0x49,
//		0x20, 0x65, 0x6C, 0x70, 0x70, 0x41, 0x0A, 0x13, 0x0A, 0x04,
//		0x55, 0x03, 0x06, 0x11, 0x30, 0x13, 0x31, 0x53, 0x55, 0x02,
//		0x13, 0x06, 0x04, 0x55, 0x03, 0x06, 0x09, 0x30, 0x0B, 0x31,
//		0x70, 0x30, 0x5A, 0x34, 0x35, 0x33, 0x30, 0x31, 0x30, 0x38,
//		0x30, 0x35, 0x30, 0x32, 0x32, 0x0D, 0x17, 0x5A, 0x34, 0x35,
//		0x33, 0x30, 0x31, 0x30, 0x38, 0x30, 0x35, 0x30, 0x34, 0x31,
//		0x0D, 0x17, 0x1E, 0x30, 0x79, 0x74, 0x69, 0x72, 0x6F, 0x68,
//		0x74, 0x75, 0x41, 0x20, 0x6E, 0x6F, 0x69, 0x74, 0x61, 0x63,
//		0x69, 0x66, 0x69, 0x74, 0x72, 0x65, 0x43, 0x20, 0x73, 0x65,
//		0x69, 0x72, 0x6F, 0x73, 0x73, 0x65, 0x63, 0x63, 0x41, 0x20,
//		0x64, 0x6F, 0x50, 0x69, 0x20, 0x65, 0x6C, 0x70, 0x70, 0x41,
//		0x2E, 0x13, 0x03, 0x04, 0x55, 0x03, 0x06, 0x35, 0x30, 0x37,
//		0x31, 0x79, 0x74, 0x69, 0x72, 0x6F, 0x68, 0x74, 0x75, 0x41,
//		0x20, 0x6E, 0x6F, 0x69, 0x74, 0x61, 0x63, 0x69, 0x66, 0x69,
//		0x74, 0x72, 0x65, 0x43, 0x20, 0x65, 0x6C, 0x70, 0x70, 0x41,
//		0x1D, 0x13, 0x0B, 0x04, 0x55, 0x03, 0x06, 0x24, 0x30, 0x26,
//		0x31, 0x2E, 0x63, 0x6E, 0x49, 0x20, 0x65, 0x6C, 0x70, 0x70,
//		0x41, 0x0A, 0x13, 0x0A, 0x04, 0x55, 0x03, 0x06, 0x11, 0x30,
//		0x13, 0x31, 0x53, 0x55, 0x02, 0x13, 0x06, 0x04, 0x55, 0x03,
//		0x06, 0x09, 0x30, 0x0B, 0x31, 0x83, 0x81, 0x30, 0x00, 0x05,
//		0x05, 0x01, 0x01, 0x0D, 0xF7, 0x86, 0x48, 0x86, 0x2A, 0x09,
//		0x06, 0x0D, 0x30, 0x01, 0x00, 0x00, 0xAA, 0x03, 0x00, 0xAA,
//		0x0B, 0xAA, 0x08, 0x05, 0x14, 0xAA, 0x33, 0x33, 0x0F, 0x02,
//		0x02, 0x01, 0x02, 0x03, 0xA0, 0x41, 0x02, 0x82, 0x30, 0x59,
//		0x03, 0x82, 0x30, 0x5D, 0x03, 0x82, 0xA0, 0x01, 0x07, 0x01,
//		0x0D, 0xF7, 0x86, 0x48, 0x86, 0x2A, 0x09, 0x06, 0x0B, 0x30,
//		0x00, 0x31, 0x01, 0x01, 0x02, 0x77, 0x03, 0x82, 0x30, 0x7B,
//		0x03, 0x82, 0xA0, 0x02, 0x07, 0x01, 0x0D, 0xF7, 0x86, 0x48,
//		0x86, 0x2A, 0x09, 0x06, 0x8A, 0x03, 0x82, 0x30
//};
//
//const uint8_t AM0_CERT_PRIV_KEY[] = {
//		0x66, 0x76, 0x23, 0xE0, 0x05, 0x81, 0x8D, 0xE2, 0x46, 0xAC,
//		0xC9, 0xF2, 0x29, 0x56, 0x94, 0x79, 0x21, 0x19, 0x5B, 0x79,
//		0xFC, 0x2C, 0x92, 0x1E, 0x60, 0x04, 0x6F, 0xBD, 0x54, 0x48,
//		0x90, 0xFD, 0x97, 0xDD, 0xE2, 0xCE, 0x0D, 0x04, 0xEE, 0x2E,
//		0x71, 0x30, 0x05, 0xAA, 0x87, 0xE8, 0xBE, 0x14, 0x84, 0xD7,
//		0xEC, 0x91, 0x3E, 0xB8, 0x92, 0x98, 0x40, 0x6C, 0x2F, 0xA7,
//		0x1A, 0x6F, 0x74, 0x04, 0xB9, 0xD8, 0xA0, 0x55, 0xF9, 0xD1,
//		0x5D, 0x4C, 0xF7, 0x24, 0x25, 0x2B, 0x9E, 0xA3, 0x94, 0x3F,
//		0xB4, 0xAD, 0xD0, 0x67, 0xDF, 0x32, 0x6F, 0x8C, 0xB4, 0x04,
//		0x57, 0x8C, 0xEF, 0xC4, 0xE3, 0x68, 0x4A, 0xD5, 0xC9, 0xF6,
//		0x47, 0x3F, 0x07, 0x51, 0xFC, 0xF5, 0x72, 0xC4, 0x8F, 0x89,
//		0xF1, 0x1E, 0x6A, 0x97, 0x61, 0xE5, 0x26, 0x29, 0x78, 0x1D,
//		0xD5, 0x45, 0xB5, 0x52, 0x26, 0x1A, 0x4E, 0x68, 0x03, 0xB5,
//		0x30, 0x79, 0xC2, 0x2F, 0x93, 0xB0, 0x72, 0x7E, 0x69, 0x38,
//		0x91, 0x5E, 0x33, 0x71, 0x73, 0x73, 0xF9, 0x5A, 0x01, 0xEF,
//		0x91, 0x4F, 0x1C, 0x1E, 0xDD, 0xAA, 0x76, 0xA5, 0x2D, 0x31,
//		0xEA, 0x76, 0xBE, 0x71, 0x8F, 0x89, 0x1F, 0x88, 0x35, 0x0D,
//		0xBF, 0x3B, 0x5F, 0x33, 0xD1, 0xB7, 0x6E, 0x51, 0xD3, 0xE2,
//		0xC2, 0x4C, 0xA2, 0x7B, 0x49, 0x32, 0xCE, 0x85, 0x38, 0x18,
//		0xBD, 0xCB, 0xF5, 0x06, 0x30, 0x31, 0x4C, 0xAD, 0xA8, 0x3A,
//		0x65, 0x5F, 0x6F, 0x86, 0xA6, 0x02, 0xD4, 0xA1, 0x9E, 0xCE,
//		0x1C, 0xF4, 0x9D, 0x83, 0x15, 0x36, 0xC2, 0xC9, 0xE8, 0x18,
//		0x74, 0x7E, 0x5C, 0x76, 0x76, 0x0C, 0x22, 0x00, 0x4B, 0x87,
//		0xB7, 0x87, 0xC2, 0x61, 0x6E, 0xD6, 0xA1, 0x34, 0x39, 0xE5,
//		0x4B, 0xC0, 0x2E, 0xE2, 0xC4, 0x29, 0x95, 0xA3, 0xBC, 0x85,
//		0x75, 0x23, 0x3C, 0xA1, 0xD1, 0xE0, 0xF3, 0xBD, 0x2C, 0x64,
//		0xFC, 0xAD, 0xB2, 0xD4, 0x71, 0x2F, 0xA3, 0x95, 0x03, 0xEF,
//		0x2F, 0x48, 0x07, 0x05, 0xDE, 0xEE, 0x5C, 0x12, 0xCF, 0x1E,
//		0x77, 0x50, 0x41, 0xAB, 0x95, 0x5A, 0xA1, 0x35, 0x7D, 0x25,
//		0x70, 0xF2, 0x92, 0x10, 0x4A, 0x60, 0x85, 0x81, 0xC9, 0xE8,
//		0x03, 0xE3, 0xE8, 0xFB, 0xC9, 0x64, 0x5A, 0x99, 0x13, 0x20,
//		0x3C, 0xEB, 0x6F, 0xBF, 0xFF, 0x04, 0x7E, 0x11, 0xA0, 0xF8
//};

////////////////////////////////////////////////////////////////////////////////////////
// from CEVA (cert_id = 0): A(512 bytes) + B(398 bytes) = 910 bytes; priv(320 bytes)
// REVERSED of all bytes in the 2 buffers (reverse possibility #1)
const uint8_t AM0_CERT_DATA[] = {
		0x30, 0x82, 0x03, 0x8A, 0x06, 0x09, 0x2A, 0x86, 0x48, 0x86,
		0xF7, 0x0D, 0x01, 0x07, 0x02, 0xA0, 0x82, 0x03, 0x7B, 0x30,
		0x82, 0x03, 0x77, 0x02, 0x01, 0x01, 0x31, 0x00, 0x30, 0x0B,
		0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x07,
		0x01, 0xA0, 0x82, 0x03, 0x5D, 0x30, 0x82, 0x03, 0x59, 0x30,
		0x82, 0x02, 0x41, 0xA0, 0x03, 0x02, 0x01, 0x02, 0x02, 0x0F,
		0x33, 0x33, 0xAA, 0x14, 0x05, 0x08, 0xAA, 0x0B, 0xAA, 0x00,
		0x03, 0xAA, 0x00, 0x00, 0x01, 0x30, 0x0D, 0x06, 0x09, 0x2A,
		0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01, 0x05, 0x05, 0x00,
		0x30, 0x81, 0x83, 0x31, 0x0B, 0x30, 0x09, 0x06, 0x03, 0x55,
		0x04, 0x06, 0x13, 0x02, 0x55, 0x53, 0x31, 0x13, 0x30, 0x11,
		0x06, 0x03, 0x55, 0x04, 0x0A, 0x13, 0x0A, 0x41, 0x70, 0x70,
		0x6C, 0x65, 0x20, 0x49, 0x6E, 0x63, 0x2E, 0x31, 0x26, 0x30,
		0x24, 0x06, 0x03, 0x55, 0x04, 0x0B, 0x13, 0x1D, 0x41, 0x70,
		0x70, 0x6C, 0x65, 0x20, 0x43, 0x65, 0x72, 0x74, 0x69, 0x66,
		0x69, 0x63, 0x61, 0x74, 0x69, 0x6F, 0x6E, 0x20, 0x41, 0x75,
		0x74, 0x68, 0x6F, 0x72, 0x69, 0x74, 0x79, 0x31, 0x37, 0x30,
		0x35, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x2E, 0x41, 0x70,
		0x70, 0x6C, 0x65, 0x20, 0x69, 0x50, 0x6F, 0x64, 0x20, 0x41,
		0x63, 0x63, 0x65, 0x73, 0x73, 0x6F, 0x72, 0x69, 0x65, 0x73,
		0x20, 0x43, 0x65, 0x72, 0x74, 0x69, 0x66, 0x69, 0x63, 0x61,
		0x74, 0x69, 0x6F, 0x6E, 0x20, 0x41, 0x75, 0x74, 0x68, 0x6F,
		0x72, 0x69, 0x74, 0x79, 0x30, 0x1E, 0x17, 0x0D, 0x31, 0x34,
		0x30, 0x35, 0x30, 0x38, 0x30, 0x31, 0x30, 0x33, 0x35, 0x34,
		0x5A, 0x17, 0x0D, 0x32, 0x32, 0x30, 0x35, 0x30, 0x38, 0x30,
		0x31, 0x30, 0x33, 0x35, 0x34, 0x5A, 0x30, 0x70, 0x31, 0x0B,
		0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x55,
		0x53, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55, 0x04, 0x0A,
		0x13, 0x0A, 0x41, 0x70, 0x70, 0x6C, 0x65, 0x20, 0x49, 0x6E,
		0x63, 0x2E, 0x31, 0x1F, 0x30, 0x1D, 0x06, 0x03, 0x55, 0x04,
		0x0B, 0x13, 0x16, 0x41, 0x70, 0x70, 0x6C, 0x65, 0x20, 0x69,
		0x50, 0x6F, 0x64, 0x20, 0x41, 0x63, 0x63, 0x65, 0x73, 0x73,
		0x6F, 0x72, 0x69, 0x65, 0x73, 0x31, 0x2B, 0x30, 0x29, 0x06,
		0x03, 0x55, 0x04, 0x03, 0x14, 0x22, 0x49, 0x50, 0x41, 0x5F,
		0x33, 0x33, 0x33, 0x33, 0x41, 0x41, 0x31, 0x34, 0x30, 0x35,
		0x30, 0x38, 0x41, 0x41, 0x30, 0x42, 0x41, 0x41, 0x30, 0x30,
		0x30, 0x33, 0x41, 0x41, 0x30, 0x30, 0x30, 0x30, 0x30, 0x31,
		0x30, 0x81, 0x9F, 0x30, 0x0D, 0x06, 0x09, 0x2A, 0x86, 0x48,
		0x86, 0xF7, 0x0D, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x81,
		0x8D, 0x00, 0x30, 0x81, 0x89, 0x02, 0x81, 0x81, 0x00, 0xDA,
		0x57, 0xA6, 0x93, 0x9F, 0x36, 0x3C, 0x69, 0xD2, 0x53, 0x43,
		0x64, 0xE2, 0x95, 0xA3, 0x48, 0xC3, 0xB7, 0x05, 0x81, 0x31,
		0x3E, 0x55, 0x55, 0x83, 0x6D, 0x19, 0x10, 0xCF, 0x1C, 0x11,
		0xCD, 0x1B, 0x2B, 0x45, 0x65, 0x91, 0x6A, 0xD5, 0x54, 0x63,
		0x44, 0x9D, 0x37, 0x69, 0x2C, 0xF7, 0x49, 0xC4, 0xB2, 0xCF,
		0x32, 0x83, 0x14, 0x5B, 0x3A, 0x8E, 0x41, 0xD9, 0x7F, 0xDF,
		0xFF, 0x1F, 0x56, 0x88, 0x9F, 0x33, 0x09, 0xD5, 0xB3, 0x67,
		0x10, 0xD8, 0x09, 0x28, 0x6D, 0xB6, 0xED, 0x4D, 0xE9, 0xEE,
		0x96, 0x42, 0x26, 0xE7, 0x9C, 0x90, 0x4E, 0x37, 0x7D, 0x4A,
		0xAD, 0xDD, 0x9E, 0xDF, 0x86, 0xD8, 0x4B, 0x8B, 0xB9, 0x33,
		0xD3, 0xDB, 0xA8, 0x3F, 0xD7, 0xB2, 0x6D, 0xB9, 0xBD, 0x9D,
		0xBD, 0x8A,
		0xD9, 0x6B, 0xF8, 0xA6, 0xCB, 0x5C, 0x9F, 0x5C, 0xB1, 0x60,
		0xC8, 0x0B, 0xD5, 0x7B, 0x8F, 0x02, 0x03, 0x01, 0x00, 0x01,
		0xA3, 0x60, 0x30, 0x5E, 0x30, 0x0E, 0x06, 0x03, 0x55, 0x1D,
		0x0F, 0x01, 0x01, 0xFF, 0x04, 0x04, 0x03, 0x02, 0x03, 0xB8,
		0x30, 0x0C, 0x06, 0x03, 0x55, 0x1D, 0x13, 0x01, 0x01, 0xFF,
		0x04, 0x02, 0x30, 0x00, 0x30, 0x1D, 0x06, 0x03, 0x55, 0x1D,
		0x0E, 0x04, 0x16, 0x04, 0x14, 0x51, 0x99, 0xA3, 0xE1, 0xFF,
		0x0B, 0xF2, 0xF2, 0xA5, 0xC0, 0x4B, 0xEE, 0x22, 0x64, 0xE6,
		0x31, 0x89, 0x7F, 0x16, 0xBA, 0x30, 0x1F, 0x06, 0x03, 0x55,
		0x1D, 0x23, 0x04, 0x18, 0x30, 0x16, 0x80, 0x14, 0xFF, 0x4B,
		0x1A, 0x43, 0x9A, 0xF5, 0x19, 0x96, 0xAB, 0x18, 0x00, 0x2B,
		0x61, 0xC9, 0xEE, 0x40, 0x9D, 0x8E, 0xC7, 0x04, 0x30, 0x0D,
		0x06, 0x09, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x01, 0x01,
		0x05, 0x05, 0x00, 0x03, 0x82, 0x01, 0x01, 0x00, 0x9F, 0xB4,
		0xD1, 0x63, 0x56, 0x28, 0xF5, 0xF1, 0xF1, 0x2E, 0x14, 0x08,
		0xFA, 0x30, 0x58, 0xB2, 0x0D, 0xE3, 0x71, 0x71, 0xA0, 0xBF,
		0x55, 0xA9, 0xB6, 0x4D, 0xB7, 0x03, 0xA8, 0x6A, 0xAE, 0x45,
		0x69, 0x6A, 0x65, 0x5C, 0x21, 0xB8, 0xF1, 0x93, 0x84, 0x15,
		0x10, 0x77, 0x7E, 0xFB, 0x7A, 0x65, 0xCC, 0xB8, 0x97, 0x6C,
		0xCF, 0x09, 0xC0, 0x35, 0xF5, 0xD7, 0x6D, 0x8C, 0xA3, 0x57,
		0xDB, 0xAC, 0x1A, 0xC5, 0xED, 0xDF, 0xDB, 0xF6, 0x8D, 0x0F,
		0x1B, 0x2F, 0x09, 0x20, 0x88, 0xD0, 0x73, 0x53, 0xA8, 0xFC,
		0xBC, 0x26, 0x80, 0x07, 0x92, 0xE9, 0xEF, 0xC3, 0x7B, 0xFD,
		0x63, 0x96, 0xD8, 0x8C, 0x66, 0x0C, 0xA9, 0x87, 0xCA, 0xA4,
		0x92, 0x2D, 0xAF, 0x26, 0xD6, 0x03, 0xEC, 0xB5, 0x0F, 0x87,
		0x7F, 0xBA, 0xC3, 0x41, 0xD1, 0x1F, 0xFA, 0xC2, 0xD7, 0x5F,
		0xAE, 0xD9, 0x48, 0xCB, 0x9E, 0x2C, 0x76, 0x92, 0x91, 0x2F,
		0xA4, 0xBF, 0x97, 0x40, 0x08, 0x6E, 0xE0, 0x30, 0x0B, 0xC7,
		0xE5, 0x58, 0x8F, 0xF2, 0x9D, 0xD9, 0x95, 0x03, 0x83, 0x08,
		0xBF, 0x90, 0xB3, 0x41, 0x8F, 0xEF, 0x3D, 0xD6, 0xAF, 0x06,
		0x78, 0xCE, 0x18, 0x7C, 0x41, 0xC3, 0x95, 0x74, 0xDE, 0x2A,
		0x06, 0xD8, 0xF8, 0x8F, 0xA9, 0x84, 0xA6, 0xC9, 0x11, 0xEB,
		0x24, 0x9B, 0x7A, 0x31, 0x39, 0xA6, 0xF6, 0x20, 0x59, 0xCE,
		0x0C, 0x2D, 0x6C, 0x87, 0x64, 0xBE, 0x53, 0x46, 0x71, 0xD0,
		0xCF, 0x7B, 0x7D, 0xCD, 0xDB, 0x68, 0x39, 0xA7, 0xA8, 0xEC,
		0xC4, 0xB1, 0x80, 0x73, 0xD2, 0x06, 0x12, 0x21, 0x82, 0x7F,
		0x45, 0x3F, 0x87, 0xF0, 0x1E, 0xEB, 0x94, 0x41, 0x81, 0xE2,
		0x57, 0x8D, 0x87, 0xD9, 0x24, 0x6F, 0x09, 0x70, 0x12, 0xBA,
		0xF5, 0x90, 0xD5, 0x89, 0x67, 0x67, 0x1B, 0xA3, 0x8C, 0x49,
		0x52, 0x29, 0x3C, 0xEC, 0xA1, 0x00, 0x31, 0x00
};

const uint8_t AM0_CERT_PRIV_KEY[] = {
		0xF8, 0xA0, 0x11, 0x7E, 0x04, 0xFF, 0xBF, 0x6F, 0xEB, 0x3C,
		0x20, 0x13, 0x99, 0x5A, 0x64, 0xC9, 0xFB, 0xE8, 0xE3, 0x03,
		0xE8, 0xC9, 0x81, 0x85, 0x60, 0x4A, 0x10, 0x92, 0xF2, 0x70,
		0x25, 0x7D, 0x35, 0xA1, 0x5A, 0x95, 0xAB, 0x41, 0x50, 0x77,
		0x1E, 0xCF, 0x12, 0x5C, 0xEE, 0xDE, 0x05, 0x07, 0x48, 0x2F,
		0xEF, 0x03, 0x95, 0xA3, 0x2F, 0x71, 0xD4, 0xB2, 0xAD, 0xFC,
		0x64, 0x2C, 0xBD, 0xF3, 0xE0, 0xD1, 0xA1, 0x3C, 0x23, 0x75,
		0x85, 0xBC, 0xA3, 0x95, 0x29, 0xC4, 0xE2, 0x2E, 0xC0, 0x4B,
		0xE5, 0x39, 0x34, 0xA1, 0xD6, 0x6E, 0x61, 0xC2, 0x87, 0xB7,
		0x87, 0x4B, 0x00, 0x22, 0x0C, 0x76, 0x76, 0x5C, 0x7E, 0x74,
		0x18, 0xE8, 0xC9, 0xC2, 0x36, 0x15, 0x83, 0x9D, 0xF4, 0x1C,
		0xCE, 0x9E, 0xA1, 0xD4, 0x02, 0xA6, 0x86, 0x6F, 0x5F, 0x65,
		0x3A, 0xA8, 0xAD, 0x4C, 0x31, 0x30, 0x06, 0xF5, 0xCB, 0xBD,
		0x18, 0x38, 0x85, 0xCE, 0x32, 0x49, 0x7B, 0xA2, 0x4C, 0xC2,
		0xE2, 0xD3, 0x51, 0x6E, 0xB7, 0xD1, 0x33, 0x5F, 0x3B, 0xBF,
		0x0D, 0x35, 0x88, 0x1F, 0x89, 0x8F, 0x71, 0xBE, 0x76, 0xEA,
		0x31, 0x2D, 0xA5, 0x76, 0xAA, 0xDD, 0x1E, 0x1C, 0x4F, 0x91,
		0xEF, 0x01, 0x5A, 0xF9, 0x73, 0x73, 0x71, 0x33, 0x5E, 0x91,
		0x38, 0x69, 0x7E, 0x72, 0xB0, 0x93, 0x2F, 0xC2, 0x79, 0x30,
		0xB5, 0x03, 0x68, 0x4E, 0x1A, 0x26, 0x52, 0xB5, 0x45, 0xD5,
		0x1D, 0x78, 0x29, 0x26, 0xE5, 0x61, 0x97, 0x6A, 0x1E, 0xF1,
		0x89, 0x8F, 0xC4, 0x72, 0xF5, 0xFC, 0x51, 0x07, 0x3F, 0x47,
		0xF6, 0xC9, 0xD5, 0x4A, 0x68, 0xE3, 0xC4, 0xEF, 0x8C, 0x57,
		0x04, 0xB4, 0x8C, 0x6F, 0x32, 0xDF, 0x67, 0xD0, 0xAD, 0xB4,
		0x3F, 0x94, 0xA3, 0x9E, 0x2B, 0x25, 0x24, 0xF7, 0x4C, 0x5D,
		0xD1, 0xF9, 0x55, 0xA0, 0xD8, 0xB9, 0x04, 0x74, 0x6F, 0x1A,
		0xA7, 0x2F, 0x6C, 0x40, 0x98, 0x92, 0xB8, 0x3E, 0x91, 0xEC,
		0xD7, 0x84, 0x14, 0xBE, 0xE8, 0x87, 0xAA, 0x05, 0x30, 0x71,
		0x2E, 0xEE, 0x04, 0x0D, 0xCE, 0xE2, 0xDD, 0x97, 0xFD, 0x90,
		0x48, 0x54, 0xBD, 0x6F, 0x04, 0x60, 0x1E, 0x92, 0x2C, 0xFC,
		0x79, 0x5B, 0x19, 0x21, 0x79, 0x94, 0x56, 0x29, 0xF2, 0xC9,
		0xAC, 0x46, 0xE2, 0x8D, 0x81, 0x05, 0xE0, 0x23, 0x76, 0x66
};

////////////////////////////////////////////////////////////////////////////////////////
// from CEVA (cert_id = 0): A(512 bytes) + B(398 bytes) = 910 bytes; priv(320 bytes)
// REVERSED of all bytes in the 2 buffers (reverse possibility #2)
//const uint8_t AM0_CERT_DATA[] = {
//		0x03, 0x28, 0x30, 0xA8, 0x60, 0x90, 0xA2, 0x68, 0x84, 0x68,
//		0x7F, 0xD0, 0x10, 0x70, 0x20, 0x0A, 0x28, 0x30, 0xB7, 0x03,
//		0x28, 0x30, 0x77, 0x20, 0x10, 0x10, 0x13, 0x00, 0x03, 0xB0,
//		0x60, 0x90, 0xA2, 0x68, 0x84, 0x68, 0x7F, 0xD0, 0x10, 0x70,
//		0x10, 0x0A, 0x28, 0x30, 0xD5, 0x03, 0x28, 0x30, 0x95, 0x03,
//		0x28, 0x20, 0x14, 0x0A, 0x30, 0x20, 0x10, 0x20, 0x20, 0xF0,
//		0x33, 0x33, 0xAA, 0x41, 0x50, 0x80, 0xAA, 0xB0, 0xAA, 0x00,
//		0x30, 0xAA, 0x00, 0x00, 0x10, 0x03, 0xD0, 0x60, 0x90, 0xA2,
//		0x68, 0x84, 0x68, 0x7F, 0xD0, 0x10, 0x10, 0x50, 0x50, 0x00,
//		0x03, 0x18, 0x38, 0x13, 0xB0, 0x03, 0x90, 0x60, 0x30, 0x55,
//		0x40, 0x60, 0x31, 0x20, 0x55, 0x35, 0x13, 0x31, 0x03, 0x11,
//		0x60, 0x30, 0x55, 0x40, 0xA0, 0x31, 0xA0, 0x14, 0x07, 0x07,
//		0xC6, 0x56, 0x02, 0x94, 0xE6, 0x36, 0xE2, 0x13, 0x62, 0x03,
//		0x42, 0x60, 0x30, 0x55, 0x40, 0xB0, 0x31, 0xD1, 0x14, 0x07,
//		0x07, 0xC6, 0x56, 0x02, 0x34, 0x56, 0x27, 0x47, 0x96, 0x66,
//		0x96, 0x36, 0x16, 0x47, 0x96, 0xF6, 0xE6, 0x02, 0x14, 0x57,
//		0x47, 0x86, 0xF6, 0x27, 0x96, 0x47, 0x97, 0x13, 0x73, 0x03,
//		0x53, 0x60, 0x30, 0x55, 0x40, 0x30, 0x31, 0xE2, 0x14, 0x07,
//		0x07, 0xC6, 0x56, 0x02, 0x96, 0x05, 0xF6, 0x46, 0x02, 0x14,
//		0x36, 0x36, 0x56, 0x37, 0x37, 0xF6, 0x27, 0x96, 0x56, 0x37,
//		0x02, 0x34, 0x56, 0x27, 0x47, 0x96, 0x66, 0x96, 0x36, 0x16,
//		0x47, 0x96, 0xF6, 0xE6, 0x02, 0x14, 0x57, 0x47, 0x86, 0xF6,
//		0x27, 0x96, 0x47, 0x97, 0x03, 0xE1, 0x71, 0xD0, 0x13, 0x43,
//		0x03, 0x53, 0x03, 0x83, 0x03, 0x13, 0x03, 0x33, 0x53, 0x43,
//		0xA5, 0x71, 0xD0, 0x23, 0x23, 0x03, 0x53, 0x03, 0x83, 0x03,
//		0x13, 0x03, 0x33, 0x53, 0x43, 0xA5, 0x03, 0x07, 0x13, 0xB0,
//		0x03, 0x90, 0x60, 0x30, 0x55, 0x40, 0x60, 0x31, 0x20, 0x55,
//		0x35, 0x13, 0x31, 0x03, 0x11, 0x60, 0x30, 0x55, 0x40, 0xA0,
//		0x31, 0xA0, 0x14, 0x07, 0x07, 0xC6, 0x56, 0x02, 0x94, 0xE6,
//		0x36, 0xE2, 0x13, 0xF1, 0x03, 0xD1, 0x60, 0x30, 0x55, 0x40,
//		0xB0, 0x31, 0x61, 0x14, 0x07, 0x07, 0xC6, 0x56, 0x02, 0x96,
//		0x05, 0xF6, 0x46, 0x02, 0x14, 0x36, 0x36, 0x56, 0x37, 0x37,
//		0xF6, 0x27, 0x96, 0x56, 0x37, 0x13, 0xB2, 0x03, 0x92, 0x60,
//		0x30, 0x55, 0x40, 0x30, 0x41, 0x22, 0x94, 0x05, 0x14, 0xF5,
//		0x33, 0x33, 0x33, 0x33, 0x14, 0x14, 0x13, 0x43, 0x03, 0x53,
//		0x03, 0x83, 0x14, 0x14, 0x03, 0x24, 0x14, 0x14, 0x03, 0x03,
//		0x03, 0x33, 0x14, 0x14, 0x03, 0x03, 0x03, 0x03, 0x03, 0x13,
//		0x03, 0x18, 0xF9, 0x03, 0xD0, 0x60, 0x90, 0xA2, 0x68, 0x84,
//		0x68, 0x7F, 0xD0, 0x10, 0x10, 0x10, 0x50, 0x00, 0x30, 0x18,
//		0xD8, 0x00, 0x03, 0x18, 0x98, 0x20, 0x18, 0x18, 0x00, 0xAD,
//		0x75, 0x6A, 0x39, 0xF9, 0x63, 0xC3, 0x96, 0x2D, 0x35, 0x34,
//		0x46, 0x2E, 0x59, 0x3A, 0x84, 0x3C, 0x7B, 0x50, 0x18, 0x13,
//		0xE3, 0x55, 0x55, 0x38, 0xD6, 0x91, 0x01, 0xFC, 0xC1, 0x11,
//		0xDC, 0xB1, 0xB2, 0x54, 0x56, 0x19, 0xA6, 0x5D, 0x45, 0x36,
//		0x44, 0xD9, 0x73, 0x96, 0xC2, 0x7F, 0x94, 0x4C, 0x2B, 0xFC,
//		0x23, 0x38, 0x41, 0xB5, 0xA3, 0xE8, 0x14, 0x9D, 0xF7, 0xFD,
//		0xFF, 0xF1, 0x65, 0x88, 0xF9, 0x33, 0x90, 0x5D, 0x3B, 0x76,
//		0x01, 0x8D, 0x90, 0x82, 0xD6, 0x6B, 0xDE, 0xD4, 0x9E, 0xEE,
//		0x69, 0x24, 0x62, 0x7E, 0xC9, 0x09, 0xE4, 0x73, 0xD7, 0xA4,
//		0xDA, 0xDD, 0xE9, 0xFD, 0x68, 0x8D, 0xB4, 0xB8, 0x9B, 0x33,
//		0x3D, 0xBD, 0x8A, 0xF3, 0x7D, 0x2B, 0xD6, 0x9B, 0xDB, 0xD9,
//		0xDB, 0xA8, 0x9D, 0xB6, 0x8F, 0x6A, 0xBC, 0xC5, 0xF9, 0xC5,
//		0x1B, 0x06, 0x8C, 0xB0, 0x5D, 0xB7, 0xF8, 0x20, 0x30, 0x10,
//		0x00, 0x10, 0x3A, 0x06, 0x03, 0xE5, 0x03, 0xE0, 0x60, 0x30,
//		0x55, 0xD1, 0xF0, 0x10, 0x10, 0xFF, 0x40, 0x40, 0x30, 0x20,
//		0x30, 0x8B, 0x03, 0xC0, 0x60, 0x30, 0x55, 0xD1, 0x31, 0x10,
//		0x10, 0xFF, 0x40, 0x20, 0x03, 0x00, 0x03, 0xD1, 0x60, 0x30,
//		0x55, 0xD1, 0xE0, 0x40, 0x61, 0x40, 0x41, 0x15, 0x99, 0x3A,
//		0x1E, 0xFF, 0xB0, 0x2F, 0x2F, 0x5A, 0x0C, 0xB4, 0xEE, 0x22,
//		0x46, 0x6E, 0x13, 0x98, 0xF7, 0x61, 0xAB, 0x03, 0xF1, 0x60,
//		0x30, 0x55, 0xD1, 0x32, 0x40, 0x81, 0x03, 0x61, 0x08, 0x41,
//		0xFF, 0xB4, 0xA1, 0x34, 0xA9, 0x5F, 0x91, 0x69, 0xBA, 0x81,
//		0x00, 0xB2, 0x16, 0x9C, 0xEE, 0x04, 0xD9, 0xE8, 0x7C, 0x40,
//		0x03, 0xD0, 0x60, 0x90, 0xA2, 0x68, 0x84, 0x68, 0x7F, 0xD0,
//		0x10, 0x10, 0x50, 0x50, 0x00, 0x30, 0x28, 0x10, 0x10, 0x00,
//		0xF9, 0x4B, 0x1D, 0x36, 0x65, 0x82, 0x5F, 0x1F, 0x1F, 0xE2,
//		0x41, 0x80, 0xAF, 0x03, 0x85, 0x2B, 0xD0, 0x3E, 0x17, 0x17,
//		0x0A, 0xFB, 0x55, 0x9A, 0x6B, 0xD4, 0x7B, 0x30, 0x8A, 0xA6,
//		0xEA, 0x54, 0x96, 0xA6, 0x56, 0xC5, 0x12, 0x8B, 0x1F, 0x39,
//		0x48, 0x51, 0x01, 0x77, 0xE7, 0xBF, 0xA7, 0x56, 0xCC, 0x8B,
//		0x79, 0xC6, 0xFC, 0x90, 0x0C, 0x53, 0x5F, 0x7D, 0xD6, 0xC8,
//		0x3A, 0x75, 0xBD, 0xCA, 0xA1, 0x5C, 0xDE, 0xFD, 0xBD, 0x6F,
//		0xD8, 0xF0, 0xB1, 0xF2, 0x90, 0x02, 0x88, 0x0D, 0x37, 0x35,
//		0x8A, 0xCF, 0xCB, 0x62, 0x08, 0x70, 0x29, 0x9E, 0xFE, 0x3C,
//		0xB7, 0xDF, 0x36, 0x69, 0x8D, 0xC8, 0x66, 0xC0, 0x9A, 0x78,
//		0xAC, 0x4A, 0x29, 0xD2, 0xFA, 0x62, 0x6D, 0x30, 0xCE, 0x5B,
//		0xF0, 0x78, 0xF7, 0xAB, 0x3C, 0x14, 0x1D, 0xF1, 0xAF, 0x2C,
//		0x7D, 0xF5, 0xEA, 0x9D, 0x84, 0xBC, 0xE9, 0xC2, 0x67, 0x29,
//		0x19, 0xF2, 0x4A, 0xFB, 0x79, 0x04, 0x80, 0xE6, 0x0E, 0x03,
//		0xB0, 0x7C, 0x5E, 0x85, 0xF8, 0x2F, 0xD9, 0x9D, 0x59, 0x30,
//		0x38, 0x80, 0xFB, 0x09, 0x3B, 0x14, 0xF8, 0xFE, 0xD3, 0x6D,
//		0xFA, 0x60, 0x87, 0xEC, 0x81, 0xC7, 0x14, 0x3C, 0x59, 0x47,
//		0xED, 0xA2, 0x60, 0x8D, 0x8F, 0xF8, 0x9A, 0x48, 0x6A, 0x9C,
//		0x11, 0xBE, 0x42, 0xB9, 0xA7, 0x13, 0x93, 0x6A, 0x6F, 0x02,
//		0x95, 0xEC, 0xC0, 0xD2, 0xC6, 0x78, 0x46, 0xEB, 0x35, 0x64,
//		0x17, 0x0D, 0xFC, 0xB7, 0xD7, 0xDC, 0xBD, 0x86, 0x93, 0x7A,
//		0x8A, 0xCE, 0x4C, 0x1B, 0x08, 0x37, 0x2D, 0x60, 0x21, 0x12,
//		0x28, 0xF7, 0x54, 0xF3, 0x78, 0x0F, 0xE1, 0xBE, 0x49, 0x14,
//		0x18, 0x2E, 0x75, 0xD8, 0x78, 0x9D, 0x42, 0xF6, 0x90, 0x07,
//		0x21, 0xAB, 0x5F, 0x09, 0x5D, 0x98, 0x76, 0x76, 0xB1, 0x3A,
//		0xC8, 0x94, 0x25, 0x92, 0xC3, 0xCE, 0x1A, 0x00, 0x13, 0x00
//};
//
//const uint8_t AM0_CERT_PRIV_KEY[] = {
//		0x8F, 0x0A, 0x11, 0xE7, 0x40, 0xFF, 0xFB, 0xF6, 0xBE, 0xC3,
//		0x02, 0x31, 0x99, 0xA5, 0x46, 0x9C, 0xBF, 0x8E, 0x3E, 0x30,
//		0x8E, 0x9C, 0x18, 0x58, 0x06, 0xA4, 0x01, 0x29, 0x2F, 0x07,
//		0x52, 0xD7, 0x53, 0x1A, 0xA5, 0x59, 0xBA, 0x14, 0x05, 0x77,
//		0xE1, 0xFC, 0x21, 0xC5, 0xEE, 0xED, 0x50, 0x70, 0x84, 0xF2,
//		0xFE, 0x30, 0x59, 0x3A, 0xF2, 0x17, 0x4D, 0x2B, 0xDA, 0xCF,
//		0x46, 0xC2, 0xDB, 0x3F, 0x0E, 0x1D, 0x1A, 0xC3, 0x32, 0x57,
//		0x58, 0xCB, 0x3A, 0x59, 0x92, 0x4C, 0x2E, 0xE2, 0x0C, 0xB4,
//		0x5E, 0x93, 0x43, 0x1A, 0x6D, 0xE6, 0x16, 0x2C, 0x78, 0x7B,
//		0x78, 0xB4, 0x00, 0x22, 0xC0, 0x67, 0x67, 0xC5, 0xE7, 0x47,
//		0x81, 0x8E, 0x9C, 0x2C, 0x63, 0x51, 0x38, 0xD9, 0x4F, 0xC1,
//		0xEC, 0xE9, 0x1A, 0x4D, 0x20, 0x6A, 0x68, 0xF6, 0xF5, 0x56,
//		0xA3, 0x8A, 0xDA, 0xC4, 0x13, 0x03, 0x60, 0x5F, 0xBC, 0xDB,
//		0x81, 0x83, 0x58, 0xEC, 0x23, 0x94, 0xB7, 0x2A, 0xC4, 0x2C,
//		0x2E, 0x3D, 0x15, 0xE6, 0x7B, 0x1D, 0x33, 0xF5, 0xB3, 0xFB,
//		0xD0, 0x53, 0x88, 0xF1, 0x98, 0xF8, 0x17, 0xEB, 0x67, 0xAE,
//		0x13, 0xD2, 0x5A, 0x67, 0xAA, 0xDD, 0xE1, 0xC1, 0xF4, 0x19,
//		0xFE, 0x10, 0xA5, 0x9F, 0x37, 0x37, 0x17, 0x33, 0xE5, 0x19,
//		0x83, 0x96, 0xE7, 0x27, 0x0B, 0x39, 0xF2, 0x2C, 0x97, 0x03,
//		0x5B, 0x30, 0x86, 0xE4, 0xA1, 0x62, 0x25, 0x5B, 0x54, 0x5D,
//		0xD1, 0x87, 0x92, 0x62, 0x5E, 0x16, 0x79, 0xA6, 0xE1, 0x1F,
//		0x98, 0xF8, 0x4C, 0x27, 0x5F, 0xCF, 0x15, 0x70, 0xF3, 0x74,
//		0x6F, 0x9C, 0x5D, 0xA4, 0x86, 0x3E, 0x4C, 0xFE, 0xC8, 0x75,
//		0x40, 0x4B, 0xC8, 0xF6, 0x23, 0xFD, 0x76, 0x0D, 0xDA, 0x4B,
//		0xF3, 0x49, 0x3A, 0xE9, 0xB2, 0x52, 0x42, 0x7F, 0xC4, 0xD5,
//		0x1D, 0x9F, 0x55, 0x0A, 0x8D, 0x9B, 0x40, 0x47, 0xF6, 0xA1,
//		0x7A, 0xF2, 0xC6, 0x04, 0x89, 0x29, 0x8B, 0xE3, 0x19, 0xCE,
//		0x7D, 0x48, 0x41, 0xEB, 0x8E, 0x78, 0xAA, 0x50, 0x03, 0x17,
//		0xE2, 0xEE, 0x40, 0xD0, 0xEC, 0x2E, 0xDD, 0x79, 0xDF, 0x09,
//		0x84, 0x45, 0xDB, 0xF6, 0x40, 0x06, 0xE1, 0x29, 0xC2, 0xCF,
//		0x97, 0xB5, 0x91, 0x12, 0x97, 0x49, 0x65, 0x92, 0x2F, 0x9C,
//		0xCA, 0x64, 0x2E, 0xD8, 0x18, 0x50, 0x0E, 0x32, 0x67, 0x66
//};

////////////////////////////////////////////////////////////////////////////////////////
// from CEVA (cert_id = 0): A(512 bytes) + B(398 bytes) = 910 bytes; priv(320 bytes)
// REVERSE A and B individually (in the array, B is first, then A)
//const uint8_t AM0_CERT_DATA[] = {
//		0x81, 0x81, 0x02, 0x89, 0x81, 0x30, 0x00, 0x8D, 0x81, 0x03,
//		0x00, 0x05, 0x01, 0x01, 0x01, 0x0D, 0xF7, 0x86, 0x48, 0x86,
//		0x2A, 0x09, 0x06, 0x0D, 0x30, 0x9F, 0x81, 0x30, 0x31, 0x30,
//		0x30, 0x30, 0x30, 0x30, 0x41, 0x41, 0x33, 0x30, 0x30, 0x30,
//		0x41, 0x41, 0x42, 0x30, 0x41, 0x41, 0x38, 0x30, 0x35, 0x30,
//		0x34, 0x31, 0x41, 0x41, 0x33, 0x33, 0x33, 0x33, 0x5F, 0x41,
//		0x50, 0x49, 0x22, 0x14, 0x03, 0x04, 0x55, 0x03, 0x06, 0x29,
//		0x30, 0x2B, 0x31, 0x73, 0x65, 0x69, 0x72, 0x6F, 0x73, 0x73,
//		0x65, 0x63, 0x63, 0x41, 0x20, 0x64, 0x6F, 0x50, 0x69, 0x20,
//		0x65, 0x6C, 0x70, 0x70, 0x41, 0x16, 0x13, 0x0B, 0x04, 0x55,
//		0x03, 0x06, 0x1D, 0x30, 0x1F, 0x31, 0x2E, 0x63, 0x6E, 0x49,
//		0x20, 0x65, 0x6C, 0x70, 0x70, 0x41, 0x0A, 0x13, 0x0A, 0x04,
//		0x55, 0x03, 0x06, 0x11, 0x30, 0x13, 0x31, 0x53, 0x55, 0x02,
//		0x13, 0x06, 0x04, 0x55, 0x03, 0x06, 0x09, 0x30, 0x0B, 0x31,
//		0x70, 0x30, 0x5A, 0x34, 0x35, 0x33, 0x30, 0x31, 0x30, 0x38,
//		0x30, 0x35, 0x30, 0x32, 0x32, 0x0D, 0x17, 0x5A, 0x34, 0x35,
//		0x33, 0x30, 0x31, 0x30, 0x38, 0x30, 0x35, 0x30, 0x34, 0x31,
//		0x0D, 0x17, 0x1E, 0x30, 0x79, 0x74, 0x69, 0x72, 0x6F, 0x68,
//		0x74, 0x75, 0x41, 0x20, 0x6E, 0x6F, 0x69, 0x74, 0x61, 0x63,
//		0x69, 0x66, 0x69, 0x74, 0x72, 0x65, 0x43, 0x20, 0x73, 0x65,
//		0x69, 0x72, 0x6F, 0x73, 0x73, 0x65, 0x63, 0x63, 0x41, 0x20,
//		0x64, 0x6F, 0x50, 0x69, 0x20, 0x65, 0x6C, 0x70, 0x70, 0x41,
//		0x2E, 0x13, 0x03, 0x04, 0x55, 0x03, 0x06, 0x35, 0x30, 0x37,
//		0x31, 0x79, 0x74, 0x69, 0x72, 0x6F, 0x68, 0x74, 0x75, 0x41,
//		0x20, 0x6E, 0x6F, 0x69, 0x74, 0x61, 0x63, 0x69, 0x66, 0x69,
//		0x74, 0x72, 0x65, 0x43, 0x20, 0x65, 0x6C, 0x70, 0x70, 0x41,
//		0x1D, 0x13, 0x0B, 0x04, 0x55, 0x03, 0x06, 0x24, 0x30, 0x26,
//		0x31, 0x2E, 0x63, 0x6E, 0x49, 0x20, 0x65, 0x6C, 0x70, 0x70,
//		0x41, 0x0A, 0x13, 0x0A, 0x04, 0x55, 0x03, 0x06, 0x11, 0x30,
//		0x13, 0x31, 0x53, 0x55, 0x02, 0x13, 0x06, 0x04, 0x55, 0x03,
//		0x06, 0x09, 0x30, 0x0B, 0x31, 0x83, 0x81, 0x30, 0x00, 0x05,
//		0x05, 0x01, 0x01, 0x0D, 0xF7, 0x86, 0x48, 0x86, 0x2A, 0x09,
//		0x06, 0x0D, 0x30, 0x01, 0x00, 0x00, 0xAA, 0x03, 0x00, 0xAA,
//		0x0B, 0xAA, 0x08, 0x05, 0x14, 0xAA, 0x33, 0x33, 0x0F, 0x02,
//		0x02, 0x01, 0x02, 0x03, 0xA0, 0x41, 0x02, 0x82, 0x30, 0x59,
//		0x03, 0x82, 0x30, 0x5D, 0x03, 0x82, 0xA0, 0x01, 0x07, 0x01,
//		0x0D, 0xF7, 0x86, 0x48, 0x86, 0x2A, 0x09, 0x06, 0x0B, 0x30,
//		0x00, 0x31, 0x01, 0x01, 0x02, 0x77, 0x03, 0x82, 0x30, 0x7B,
//		0x03, 0x82, 0xA0, 0x02, 0x07, 0x01, 0x0D, 0xF7, 0x86, 0x48,
//		0x86, 0x2A, 0x09, 0x06, 0x8A, 0x03, 0x82, 0x30,
//		0x00, 0x31, 0x00, 0xA1, 0xEC, 0x3C, 0x29, 0x52, 0x49, 0x8C,
//		0xA3, 0x1B, 0x67, 0x67, 0x89, 0xD5, 0x90, 0xF5, 0xBA, 0x12,
//		0x70, 0x09, 0x6F, 0x24, 0xD9, 0x87, 0x8D, 0x57, 0xE2, 0x81,
//		0x41, 0x94, 0xEB, 0x1E, 0xF0, 0x87, 0x3F, 0x45, 0x7F, 0x82,
//		0x21, 0x12, 0x06, 0xD2, 0x73, 0x80, 0xB1, 0xC4, 0xEC, 0xA8,
//		0xA7, 0x39, 0x68, 0xDB, 0xCD, 0x7D, 0x7B, 0xCF, 0xD0, 0x71,
//		0x46, 0x53, 0xBE, 0x64, 0x87, 0x6C, 0x2D, 0x0C, 0xCE, 0x59,
//		0x20, 0xF6, 0xA6, 0x39, 0x31, 0x7A, 0x9B, 0x24, 0xEB, 0x11,
//		0xC9, 0xA6, 0x84, 0xA9, 0x8F, 0xF8, 0xD8, 0x06, 0x2A, 0xDE,
//		0x74, 0x95, 0xC3, 0x41, 0x7C, 0x18, 0xCE, 0x78, 0x06, 0xAF,
//		0xD6, 0x3D, 0xEF, 0x8F, 0x41, 0xB3, 0x90, 0xBF, 0x08, 0x83,
//		0x03, 0x95, 0xD9, 0x9D, 0xF2, 0x8F, 0x58, 0xE5, 0xC7, 0x0B,
//		0x30, 0xE0, 0x6E, 0x08, 0x40, 0x97, 0xBF, 0xA4, 0x2F, 0x91,
//		0x92, 0x76, 0x2C, 0x9E, 0xCB, 0x48, 0xD9, 0xAE, 0x5F, 0xD7,
//		0xC2, 0xFA, 0x1F, 0xD1, 0x41, 0xC3, 0xBA, 0x7F, 0x87, 0x0F,
//		0xB5, 0xEC, 0x03, 0xD6, 0x26, 0xAF, 0x2D, 0x92, 0xA4, 0xCA,
//		0x87, 0xA9, 0x0C, 0x66, 0x8C, 0xD8, 0x96, 0x63, 0xFD, 0x7B,
//		0xC3, 0xEF, 0xE9, 0x92, 0x07, 0x80, 0x26, 0xBC, 0xFC, 0xA8,
//		0x53, 0x73, 0xD0, 0x88, 0x20, 0x09, 0x2F, 0x1B, 0x0F, 0x8D,
//		0xF6, 0xDB, 0xDF, 0xED, 0xC5, 0x1A, 0xAC, 0xDB, 0x57, 0xA3,
//		0x8C, 0x6D, 0xD7, 0xF5, 0x35, 0xC0, 0x09, 0xCF, 0x6C, 0x97,
//		0xB8, 0xCC, 0x65, 0x7A, 0xFB, 0x7E, 0x77, 0x10, 0x15, 0x84,
//		0x93, 0xF1, 0xB8, 0x21, 0x5C, 0x65, 0x6A, 0x69, 0x45, 0xAE,
//		0x6A, 0xA8, 0x03, 0xB7, 0x4D, 0xB6, 0xA9, 0x55, 0xBF, 0xA0,
//		0x71, 0x71, 0xE3, 0x0D, 0xB2, 0x58, 0x30, 0xFA, 0x08, 0x14,
//		0x2E, 0xF1, 0xF1, 0xF5, 0x28, 0x56, 0x63, 0xD1, 0xB4, 0x9F,
//		0x00, 0x01, 0x01, 0x82, 0x03, 0x00, 0x05, 0x05, 0x01, 0x01,
//		0x0D, 0xF7, 0x86, 0x48, 0x86, 0x2A, 0x09, 0x06, 0x0D, 0x30,
//		0x04, 0xC7, 0x8E, 0x9D, 0x40, 0xEE, 0xC9, 0x61, 0x2B, 0x00,
//		0x18, 0xAB, 0x96, 0x19, 0xF5, 0x9A, 0x43, 0x1A, 0x4B, 0xFF,
//		0x14, 0x80, 0x16, 0x30, 0x18, 0x04, 0x23, 0x1D, 0x55, 0x03,
//		0x06, 0x1F, 0x30, 0xBA, 0x16, 0x7F, 0x89, 0x31, 0xE6, 0x64,
//		0x22, 0xEE, 0x4B, 0xC0, 0xA5, 0xF2, 0xF2, 0x0B, 0xFF, 0xE1,
//		0xA3, 0x99, 0x51, 0x14, 0x04, 0x16, 0x04, 0x0E, 0x1D, 0x55,
//		0x03, 0x06, 0x1D, 0x30, 0x00, 0x30, 0x02, 0x04, 0xFF, 0x01,
//		0x01, 0x13, 0x1D, 0x55, 0x03, 0x06, 0x0C, 0x30, 0xB8, 0x03,
//		0x02, 0x03, 0x04, 0x04, 0xFF, 0x01, 0x01, 0x0F, 0x1D, 0x55,
//		0x03, 0x06, 0x0E, 0x30, 0x5E, 0x30, 0x60, 0xA3, 0x01, 0x00,
//		0x01, 0x03, 0x02, 0x8F, 0x7B, 0xD5, 0x0B, 0xC8, 0x60, 0xB1,
//		0x5C, 0x9F, 0x5C, 0xCB, 0xA6, 0xF8, 0x6B, 0xD9, 0x8A, 0xBD,
//		0x9D, 0xBD, 0xB9, 0x6D, 0xB2, 0xD7, 0x3F, 0xA8, 0xDB, 0xD3,
//		0x33, 0xB9, 0x8B, 0x4B, 0xD8, 0x86, 0xDF, 0x9E, 0xDD, 0xAD,
//		0x4A, 0x7D, 0x37, 0x4E, 0x90, 0x9C, 0xE7, 0x26, 0x42, 0x96,
//		0xEE, 0xE9, 0x4D, 0xED, 0xB6, 0x6D, 0x28, 0x09, 0xD8, 0x10,
//		0x67, 0xB3, 0xD5, 0x09, 0x33, 0x9F, 0x88, 0x56, 0x1F, 0xFF,
//		0xDF, 0x7F, 0xD9, 0x41, 0x8E, 0x3A, 0x5B, 0x14, 0x83, 0x32,
//		0xCF, 0xB2, 0xC4, 0x49, 0xF7, 0x2C, 0x69, 0x37, 0x9D, 0x44,
//		0x63, 0x54, 0xD5, 0x6A, 0x91, 0x65, 0x45, 0x2B, 0x1B, 0xCD,
//		0x11, 0x1C, 0xCF, 0x10, 0x19, 0x6D, 0x83, 0x55, 0x55, 0x3E,
//		0x31, 0x81, 0x05, 0xB7, 0xC3, 0x48, 0xA3, 0x95, 0xE2, 0x64,
//		0x43, 0x53, 0xD2, 0x69, 0x3C, 0x36, 0x9F, 0x93, 0xA6, 0x57,
//		0xDA, 0x00
//};
//
//const uint8_t AM0_CERT_PRIV_KEY[] = {
//		0xF8, 0xA0, 0x11, 0x7E, 0x04, 0xFF, 0xBF, 0x6F, 0xEB, 0x3C,
//		0x20, 0x13, 0x99, 0x5A, 0x64, 0xC9, 0xFB, 0xE8, 0xE3, 0x03,
//		0xE8, 0xC9, 0x81, 0x85, 0x60, 0x4A, 0x10, 0x92, 0xF2, 0x70,
//		0x25, 0x7D, 0x35, 0xA1, 0x5A, 0x95, 0xAB, 0x41, 0x50, 0x77,
//		0x1E, 0xCF, 0x12, 0x5C, 0xEE, 0xDE, 0x05, 0x07, 0x48, 0x2F,
//		0xEF, 0x03, 0x95, 0xA3, 0x2F, 0x71, 0xD4, 0xB2, 0xAD, 0xFC,
//		0x64, 0x2C, 0xBD, 0xF3, 0xE0, 0xD1, 0xA1, 0x3C, 0x23, 0x75,
//		0x85, 0xBC, 0xA3, 0x95, 0x29, 0xC4, 0xE2, 0x2E, 0xC0, 0x4B,
//		0xE5, 0x39, 0x34, 0xA1, 0xD6, 0x6E, 0x61, 0xC2, 0x87, 0xB7,
//		0x87, 0x4B, 0x00, 0x22, 0x0C, 0x76, 0x76, 0x5C, 0x7E, 0x74,
//		0x18, 0xE8, 0xC9, 0xC2, 0x36, 0x15, 0x83, 0x9D, 0xF4, 0x1C,
//		0xCE, 0x9E, 0xA1, 0xD4, 0x02, 0xA6, 0x86, 0x6F, 0x5F, 0x65,
//		0x3A, 0xA8, 0xAD, 0x4C, 0x31, 0x30, 0x06, 0xF5, 0xCB, 0xBD,
//		0x18, 0x38, 0x85, 0xCE, 0x32, 0x49, 0x7B, 0xA2, 0x4C, 0xC2,
//		0xE2, 0xD3, 0x51, 0x6E, 0xB7, 0xD1, 0x33, 0x5F, 0x3B, 0xBF,
//		0x0D, 0x35, 0x88, 0x1F, 0x89, 0x8F, 0x71, 0xBE, 0x76, 0xEA,
//		0x31, 0x2D, 0xA5, 0x76, 0xAA, 0xDD, 0x1E, 0x1C, 0x4F, 0x91,
//		0xEF, 0x01, 0x5A, 0xF9, 0x73, 0x73, 0x71, 0x33, 0x5E, 0x91,
//		0x38, 0x69, 0x7E, 0x72, 0xB0, 0x93, 0x2F, 0xC2, 0x79, 0x30,
//		0xB5, 0x03, 0x68, 0x4E, 0x1A, 0x26, 0x52, 0xB5, 0x45, 0xD5,
//		0x1D, 0x78, 0x29, 0x26, 0xE5, 0x61, 0x97, 0x6A, 0x1E, 0xF1,
//		0x89, 0x8F, 0xC4, 0x72, 0xF5, 0xFC, 0x51, 0x07, 0x3F, 0x47,
//		0xF6, 0xC9, 0xD5, 0x4A, 0x68, 0xE3, 0xC4, 0xEF, 0x8C, 0x57,
//		0x04, 0xB4, 0x8C, 0x6F, 0x32, 0xDF, 0x67, 0xD0, 0xAD, 0xB4,
//		0x3F, 0x94, 0xA3, 0x9E, 0x2B, 0x25, 0x24, 0xF7, 0x4C, 0x5D,
//		0xD1, 0xF9, 0x55, 0xA0, 0xD8, 0xB9, 0x04, 0x74, 0x6F, 0x1A,
//		0xA7, 0x2F, 0x6C, 0x40, 0x98, 0x92, 0xB8, 0x3E, 0x91, 0xEC,
//		0xD7, 0x84, 0x14, 0xBE, 0xE8, 0x87, 0xAA, 0x05, 0x30, 0x71,
//		0x2E, 0xEE, 0x04, 0x0D, 0xCE, 0xE2, 0xDD, 0x97, 0xFD, 0x90,
//		0x48, 0x54, 0xBD, 0x6F, 0x04, 0x60, 0x1E, 0x92, 0x2C, 0xFC,
//		0x79, 0x5B, 0x19, 0x21, 0x79, 0x94, 0x56, 0x29, 0xF2, 0xC9,
//		0xAC, 0x46, 0xE2, 0x8D, 0x81, 0x05, 0xE0, 0x23, 0x76, 0x66
//};


////////////////////////////////////////////////////////////////////////////////////////
// from CEVA (cert_id = 0): A(512 bytes) + B(398 bytes) = 910 bytes; priv(320 bytes)
// REVERSE A and B individually (in the array, A is first, then B)
//const uint8_t AM0_CERT_DATA[] = {
//		0x8A, 0xBD, 0x9D, 0xBD, 0xB9, 0x6D, 0xB2, 0xD7, 0x3F, 0xA8,
//		0xDB, 0xD3, 0x33, 0xB9, 0x8B, 0x4B, 0xD8, 0x86, 0xDF, 0x9E,
//		0xDD, 0xAD, 0x4A, 0x7D, 0x37, 0x4E, 0x90, 0x9C, 0xE7, 0x26,
//		0x42, 0x96, 0xEE, 0xE9, 0x4D, 0xED, 0xB6, 0x6D, 0x28, 0x09,
//		0xD8, 0x10, 0x67, 0xB3, 0xD5, 0x09, 0x33, 0x9F, 0x88, 0x56,
//		0x1F, 0xFF, 0xDF, 0x7F, 0xD9, 0x41, 0x8E, 0x3A, 0x5B, 0x14,
//		0x83, 0x32, 0xCF, 0xB2, 0xC4, 0x49, 0xF7, 0x2C, 0x69, 0x37,
//		0x9D, 0x44, 0x63, 0x54, 0xD5, 0x6A, 0x91, 0x65, 0x45, 0x2B,
//		0x1B, 0xCD, 0x11, 0x1C, 0xCF, 0x10, 0x19, 0x6D, 0x83, 0x55,
//		0x55, 0x3E, 0x31, 0x81, 0x05, 0xB7, 0xC3, 0x48, 0xA3, 0x95,
//		0xE2, 0x64, 0x43, 0x53, 0xD2, 0x69, 0x3C, 0x36, 0x9F, 0x93,
//		0xA6, 0x57, 0xDA, 0x00, 0x81, 0x81, 0x02, 0x89, 0x81, 0x30,
//		0x00, 0x8D, 0x81, 0x03, 0x00, 0x05, 0x01, 0x01, 0x01, 0x0D,
//		0xF7, 0x86, 0x48, 0x86, 0x2A, 0x09, 0x06, 0x0D, 0x30, 0x9F,
//		0x81, 0x30, 0x31, 0x30, 0x30, 0x30, 0x30, 0x30, 0x41, 0x41,
//		0x33, 0x30, 0x30, 0x30, 0x41, 0x41, 0x42, 0x30, 0x41, 0x41,
//		0x38, 0x30, 0x35, 0x30, 0x34, 0x31, 0x41, 0x41, 0x33, 0x33,
//		0x33, 0x33, 0x5F, 0x41, 0x50, 0x49, 0x22, 0x14, 0x03, 0x04,
//		0x55, 0x03, 0x06, 0x29, 0x30, 0x2B, 0x31, 0x73, 0x65, 0x69,
//		0x72, 0x6F, 0x73, 0x73, 0x65, 0x63, 0x63, 0x41, 0x20, 0x64,
//		0x6F, 0x50, 0x69, 0x20, 0x65, 0x6C, 0x70, 0x70, 0x41, 0x16,
//		0x13, 0x0B, 0x04, 0x55, 0x03, 0x06, 0x1D, 0x30, 0x1F, 0x31,
//		0x2E, 0x63, 0x6E, 0x49, 0x20, 0x65, 0x6C, 0x70, 0x70, 0x41,
//		0x0A, 0x13, 0x0A, 0x04, 0x55, 0x03, 0x06, 0x11, 0x30, 0x13,
//		0x31, 0x53, 0x55, 0x02, 0x13, 0x06, 0x04, 0x55, 0x03, 0x06,
//		0x09, 0x30, 0x0B, 0x31, 0x70, 0x30, 0x5A, 0x34, 0x35, 0x33,
//		0x30, 0x31, 0x30, 0x38, 0x30, 0x35, 0x30, 0x32, 0x32, 0x0D,
//		0x17, 0x5A, 0x34, 0x35, 0x33, 0x30, 0x31, 0x30, 0x38, 0x30,
//		0x35, 0x30, 0x34, 0x31, 0x0D, 0x17, 0x1E, 0x30, 0x79, 0x74,
//		0x69, 0x72, 0x6F, 0x68, 0x74, 0x75, 0x41, 0x20, 0x6E, 0x6F,
//		0x69, 0x74, 0x61, 0x63, 0x69, 0x66, 0x69, 0x74, 0x72, 0x65,
//		0x43, 0x20, 0x73, 0x65, 0x69, 0x72, 0x6F, 0x73, 0x73, 0x65,
//		0x63, 0x63, 0x41, 0x20, 0x64, 0x6F, 0x50, 0x69, 0x20, 0x65,
//		0x6C, 0x70, 0x70, 0x41, 0x2E, 0x13, 0x03, 0x04, 0x55, 0x03,
//		0x06, 0x35, 0x30, 0x37, 0x31, 0x79, 0x74, 0x69, 0x72, 0x6F,
//		0x68, 0x74, 0x75, 0x41, 0x20, 0x6E, 0x6F, 0x69, 0x74, 0x61,
//		0x63, 0x69, 0x66, 0x69, 0x74, 0x72, 0x65, 0x43, 0x20, 0x65,
//		0x6C, 0x70, 0x70, 0x41, 0x1D, 0x13, 0x0B, 0x04, 0x55, 0x03,
//		0x06, 0x24, 0x30, 0x26, 0x31, 0x2E, 0x63, 0x6E, 0x49, 0x20,
//		0x65, 0x6C, 0x70, 0x70, 0x41, 0x0A, 0x13, 0x0A, 0x04, 0x55,
//		0x03, 0x06, 0x11, 0x30, 0x13, 0x31, 0x53, 0x55, 0x02, 0x13,
//		0x06, 0x04, 0x55, 0x03, 0x06, 0x09, 0x30, 0x0B, 0x31, 0x83,
//		0x81, 0x30, 0x00, 0x05, 0x05, 0x01, 0x01, 0x0D, 0xF7, 0x86,
//		0x48, 0x86, 0x2A, 0x09, 0x06, 0x0D, 0x30, 0x01, 0x00, 0x00,
//		0xAA, 0x03, 0x00, 0xAA, 0x0B, 0xAA, 0x08, 0x05, 0x14, 0xAA,
//		0x33, 0x33, 0x0F, 0x02, 0x02, 0x01, 0x02, 0x03, 0xA0, 0x41,
//		0x02, 0x82, 0x30, 0x59, 0x03, 0x82, 0x30, 0x5D, 0x03, 0x82,
//		0xA0, 0x01, 0x07, 0x01, 0x0D, 0xF7, 0x86, 0x48, 0x86, 0x2A,
//		0x09, 0x06, 0x0B, 0x30, 0x00, 0x31, 0x01, 0x01, 0x02, 0x77,
//		0x03, 0x82, 0x30, 0x7B, 0x03, 0x82, 0xA0, 0x02, 0x07, 0x01,
//		0x0D, 0xF7, 0x86, 0x48, 0x86, 0x2A, 0x09, 0x06, 0x8A, 0x03,
//		0x82, 0x30,
//		0x00, 0x31, 0x00, 0xA1, 0xEC, 0x3C, 0x29, 0x52, 0x49, 0x8C,
//		0xA3, 0x1B, 0x67, 0x67, 0x89, 0xD5, 0x90, 0xF5, 0xBA, 0x12,
//		0x70, 0x09, 0x6F, 0x24, 0xD9, 0x87, 0x8D, 0x57, 0xE2, 0x81,
//		0x41, 0x94, 0xEB, 0x1E, 0xF0, 0x87, 0x3F, 0x45, 0x7F, 0x82,
//		0x21, 0x12, 0x06, 0xD2, 0x73, 0x80, 0xB1, 0xC4, 0xEC, 0xA8,
//		0xA7, 0x39, 0x68, 0xDB, 0xCD, 0x7D, 0x7B, 0xCF, 0xD0, 0x71,
//		0x46, 0x53, 0xBE, 0x64, 0x87, 0x6C, 0x2D, 0x0C, 0xCE, 0x59,
//		0x20, 0xF6, 0xA6, 0x39, 0x31, 0x7A, 0x9B, 0x24, 0xEB, 0x11,
//		0xC9, 0xA6, 0x84, 0xA9, 0x8F, 0xF8, 0xD8, 0x06, 0x2A, 0xDE,
//		0x74, 0x95, 0xC3, 0x41, 0x7C, 0x18, 0xCE, 0x78, 0x06, 0xAF,
//		0xD6, 0x3D, 0xEF, 0x8F, 0x41, 0xB3, 0x90, 0xBF, 0x08, 0x83,
//		0x03, 0x95, 0xD9, 0x9D, 0xF2, 0x8F, 0x58, 0xE5, 0xC7, 0x0B,
//		0x30, 0xE0, 0x6E, 0x08, 0x40, 0x97, 0xBF, 0xA4, 0x2F, 0x91,
//		0x92, 0x76, 0x2C, 0x9E, 0xCB, 0x48, 0xD9, 0xAE, 0x5F, 0xD7,
//		0xC2, 0xFA, 0x1F, 0xD1, 0x41, 0xC3, 0xBA, 0x7F, 0x87, 0x0F,
//		0xB5, 0xEC, 0x03, 0xD6, 0x26, 0xAF, 0x2D, 0x92, 0xA4, 0xCA,
//		0x87, 0xA9, 0x0C, 0x66, 0x8C, 0xD8, 0x96, 0x63, 0xFD, 0x7B,
//		0xC3, 0xEF, 0xE9, 0x92, 0x07, 0x80, 0x26, 0xBC, 0xFC, 0xA8,
//		0x53, 0x73, 0xD0, 0x88, 0x20, 0x09, 0x2F, 0x1B, 0x0F, 0x8D,
//		0xF6, 0xDB, 0xDF, 0xED, 0xC5, 0x1A, 0xAC, 0xDB, 0x57, 0xA3,
//		0x8C, 0x6D, 0xD7, 0xF5, 0x35, 0xC0, 0x09, 0xCF, 0x6C, 0x97,
//		0xB8, 0xCC, 0x65, 0x7A, 0xFB, 0x7E, 0x77, 0x10, 0x15, 0x84,
//		0x93, 0xF1, 0xB8, 0x21, 0x5C, 0x65, 0x6A, 0x69, 0x45, 0xAE,
//		0x6A, 0xA8, 0x03, 0xB7, 0x4D, 0xB6, 0xA9, 0x55, 0xBF, 0xA0,
//		0x71, 0x71, 0xE3, 0x0D, 0xB2, 0x58, 0x30, 0xFA, 0x08, 0x14,
//		0x2E, 0xF1, 0xF1, 0xF5, 0x28, 0x56, 0x63, 0xD1, 0xB4, 0x9F,
//		0x00, 0x01, 0x01, 0x82, 0x03, 0x00, 0x05, 0x05, 0x01, 0x01,
//		0x0D, 0xF7, 0x86, 0x48, 0x86, 0x2A, 0x09, 0x06, 0x0D, 0x30,
//		0x04, 0xC7, 0x8E, 0x9D, 0x40, 0xEE, 0xC9, 0x61, 0x2B, 0x00,
//		0x18, 0xAB, 0x96, 0x19, 0xF5, 0x9A, 0x43, 0x1A, 0x4B, 0xFF,
//		0x14, 0x80, 0x16, 0x30, 0x18, 0x04, 0x23, 0x1D, 0x55, 0x03,
//		0x06, 0x1F, 0x30, 0xBA, 0x16, 0x7F, 0x89, 0x31, 0xE6, 0x64,
//		0x22, 0xEE, 0x4B, 0xC0, 0xA5, 0xF2, 0xF2, 0x0B, 0xFF, 0xE1,
//		0xA3, 0x99, 0x51, 0x14, 0x04, 0x16, 0x04, 0x0E, 0x1D, 0x55,
//		0x03, 0x06, 0x1D, 0x30, 0x00, 0x30, 0x02, 0x04, 0xFF, 0x01,
//		0x01, 0x13, 0x1D, 0x55, 0x03, 0x06, 0x0C, 0x30, 0xB8, 0x03,
//		0x02, 0x03, 0x04, 0x04, 0xFF, 0x01, 0x01, 0x0F, 0x1D, 0x55,
//		0x03, 0x06, 0x0E, 0x30, 0x5E, 0x30, 0x60, 0xA3, 0x01, 0x00,
//		0x01, 0x03, 0x02, 0x8F, 0x7B, 0xD5, 0x0B, 0xC8, 0x60, 0xB1,
//		0x5C, 0x9F, 0x5C, 0xCB, 0xA6, 0xF8, 0x6B, 0xD9
//};
//const uint8_t AM0_CERT_PRIV_KEY[] = {
//		0xF8, 0xA0, 0x11, 0x7E, 0x04, 0xFF, 0xBF, 0x6F, 0xEB, 0x3C,
//		0x20, 0x13, 0x99, 0x5A, 0x64, 0xC9, 0xFB, 0xE8, 0xE3, 0x03,
//		0xE8, 0xC9, 0x81, 0x85, 0x60, 0x4A, 0x10, 0x92, 0xF2, 0x70,
//		0x25, 0x7D, 0x35, 0xA1, 0x5A, 0x95, 0xAB, 0x41, 0x50, 0x77,
//		0x1E, 0xCF, 0x12, 0x5C, 0xEE, 0xDE, 0x05, 0x07, 0x48, 0x2F,
//		0xEF, 0x03, 0x95, 0xA3, 0x2F, 0x71, 0xD4, 0xB2, 0xAD, 0xFC,
//		0x64, 0x2C, 0xBD, 0xF3, 0xE0, 0xD1, 0xA1, 0x3C, 0x23, 0x75,
//		0x85, 0xBC, 0xA3, 0x95, 0x29, 0xC4, 0xE2, 0x2E, 0xC0, 0x4B,
//		0xE5, 0x39, 0x34, 0xA1, 0xD6, 0x6E, 0x61, 0xC2, 0x87, 0xB7,
//		0x87, 0x4B, 0x00, 0x22, 0x0C, 0x76, 0x76, 0x5C, 0x7E, 0x74,
//		0x18, 0xE8, 0xC9, 0xC2, 0x36, 0x15, 0x83, 0x9D, 0xF4, 0x1C,
//		0xCE, 0x9E, 0xA1, 0xD4, 0x02, 0xA6, 0x86, 0x6F, 0x5F, 0x65,
//		0x3A, 0xA8, 0xAD, 0x4C, 0x31, 0x30, 0x06, 0xF5, 0xCB, 0xBD,
//		0x18, 0x38, 0x85, 0xCE, 0x32, 0x49, 0x7B, 0xA2, 0x4C, 0xC2,
//		0xE2, 0xD3, 0x51, 0x6E, 0xB7, 0xD1, 0x33, 0x5F, 0x3B, 0xBF,
//		0x0D, 0x35, 0x88, 0x1F, 0x89, 0x8F, 0x71, 0xBE, 0x76, 0xEA,
//		0x31, 0x2D, 0xA5, 0x76, 0xAA, 0xDD, 0x1E, 0x1C, 0x4F, 0x91,
//		0xEF, 0x01, 0x5A, 0xF9, 0x73, 0x73, 0x71, 0x33, 0x5E, 0x91,
//		0x38, 0x69, 0x7E, 0x72, 0xB0, 0x93, 0x2F, 0xC2, 0x79, 0x30,
//		0xB5, 0x03, 0x68, 0x4E, 0x1A, 0x26, 0x52, 0xB5, 0x45, 0xD5,
//		0x1D, 0x78, 0x29, 0x26, 0xE5, 0x61, 0x97, 0x6A, 0x1E, 0xF1,
//		0x89, 0x8F, 0xC4, 0x72, 0xF5, 0xFC, 0x51, 0x07, 0x3F, 0x47,
//		0xF6, 0xC9, 0xD5, 0x4A, 0x68, 0xE3, 0xC4, 0xEF, 0x8C, 0x57,
//		0x04, 0xB4, 0x8C, 0x6F, 0x32, 0xDF, 0x67, 0xD0, 0xAD, 0xB4,
//		0x3F, 0x94, 0xA3, 0x9E, 0x2B, 0x25, 0x24, 0xF7, 0x4C, 0x5D,
//		0xD1, 0xF9, 0x55, 0xA0, 0xD8, 0xB9, 0x04, 0x74, 0x6F, 0x1A,
//		0xA7, 0x2F, 0x6C, 0x40, 0x98, 0x92, 0xB8, 0x3E, 0x91, 0xEC,
//		0xD7, 0x84, 0x14, 0xBE, 0xE8, 0x87, 0xAA, 0x05, 0x30, 0x71,
//		0x2E, 0xEE, 0x04, 0x0D, 0xCE, 0xE2, 0xDD, 0x97, 0xFD, 0x90,
//		0x48, 0x54, 0xBD, 0x6F, 0x04, 0x60, 0x1E, 0x92, 0x2C, 0xFC,
//		0x79, 0x5B, 0x19, 0x21, 0x79, 0x94, 0x56, 0x29, 0xF2, 0xC9,
//		0xAC, 0x46, 0xE2, 0x8D, 0x81, 0x05, 0xE0, 0x23, 0x76, 0x66
//};


////////////////////////////////////////////////////////////////////////////////////////

// obtained from my Python script (cert_id = 0)
//const uint8_t AM0_CERT_DATA[] = {
//		0x30, 0x82, 0x3, 0x8a, 0x6, 0x9, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0xd,
//		0x1, 0x7, 0x2, 0xa0, 0x82, 0x3, 0x7b, 0x30, 0x82, 0x3, 0x77, 0x2,
//		0x1, 0x1, 0x31, 0x0, 0x30, 0xb, 0x6, 0x9, 0x2a, 0x86, 0x48, 0x86,
//		0xf7, 0xd, 0x1, 0x7, 0x1, 0xa0, 0x82, 0x3, 0x5d, 0x30, 0x82, 0x3,
//		0x59, 0x30, 0x82, 0x2, 0x41, 0xa0, 0x3, 0x2, 0x1, 0x2, 0x2, 0xf,
//		0x33, 0x33, 0xaa, 0x14, 0x5, 0x8, 0xaa, 0xb, 0xaa, 0x0, 0x3, 0xaa,
//		0x0, 0x0, 0x1, 0x30, 0xd, 0x6, 0x9, 0x2a, 0x86, 0x48, 0x86, 0xf7,
//		0xd, 0x1, 0x1, 0x5, 0x5, 0x0, 0x30, 0x81, 0x83, 0x31, 0xb, 0x30,
//		0x9, 0x6, 0x3, 0x55, 0x4, 0x6, 0x13, 0x2, 0x55, 0x53, 0x31, 0x13,
//		0x30, 0x11, 0x6, 0x3, 0x55, 0x4, 0xa, 0x13, 0xa, 0x41, 0x70, 0x70,
//		0x6c, 0x65, 0x20, 0x49, 0x6e, 0x63, 0x2e, 0x31, 0x26, 0x30, 0x24, 0x6,
//		0x3, 0x55, 0x4, 0xb, 0x13, 0x1d, 0x41, 0x70, 0x70, 0x6c, 0x65, 0x20,
//		0x43, 0x65, 0x72, 0x74, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x69, 0x6f,
//		0x6e, 0x20, 0x41, 0x75, 0x74, 0x68, 0x6f, 0x72, 0x69, 0x74, 0x79, 0x31,
//		0x37, 0x30, 0x35, 0x6, 0x3, 0x55, 0x4, 0x3, 0x13, 0x2e, 0x41, 0x70,
//		0x70, 0x6c, 0x65, 0x20, 0x69, 0x50, 0x6f, 0x64, 0x20, 0x41, 0x63, 0x63,
//		0x65, 0x73, 0x73, 0x6f, 0x72, 0x69, 0x65, 0x73, 0x20, 0x43, 0x65, 0x72,
//		0x74, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x20, 0x41,
//		0x75, 0x74, 0x68, 0x6f, 0x72, 0x69, 0x74, 0x79, 0x30, 0x1e, 0x17, 0xd,
//		0x31, 0x34, 0x30, 0x35, 0x30, 0x38, 0x30, 0x31, 0x30, 0x33, 0x35, 0x34,
//		0x5a, 0x17, 0xd, 0x32, 0x32, 0x30, 0x35, 0x30, 0x38, 0x30, 0x31, 0x30,
//		0x33, 0x35, 0x34, 0x5a, 0x30, 0x70, 0x31, 0xb, 0x30, 0x9, 0x6, 0x3,
//		0x55, 0x4, 0x6, 0x13, 0x2, 0x55, 0x53, 0x31, 0x13, 0x30, 0x11, 0x6,
//		0x3, 0x55, 0x4, 0xa, 0x13, 0xa, 0x41, 0x70, 0x70, 0x6c, 0x65, 0x20,
//		0x49, 0x6e, 0x63, 0x2e, 0x31, 0x1f, 0x30, 0x1d, 0x6, 0x3, 0x55, 0x4,
//		0xb, 0x13, 0x16, 0x41, 0x70, 0x70, 0x6c, 0x65, 0x20, 0x69, 0x50, 0x6f,
//		0x64, 0x20, 0x41, 0x63, 0x63, 0x65, 0x73, 0x73, 0x6f, 0x72, 0x69, 0x65,
//		0x73, 0x31, 0x2b, 0x30, 0x29, 0x6, 0x3, 0x55, 0x4, 0x3, 0x14, 0x22,
//		0x49, 0x50, 0x41, 0x5f, 0x33, 0x33, 0x33, 0x33, 0x41, 0x41, 0x31, 0x34,
//		0x30, 0x35, 0x30, 0x38, 0x41, 0x41, 0x30, 0x42, 0x41, 0x41, 0x30, 0x30,
//		0x30, 0x33, 0x41, 0x41, 0x30, 0x30, 0x30, 0x30, 0x30, 0x31, 0x30, 0x81,
//		0x9f, 0x30, 0xd, 0x6, 0x9, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0xd, 0x1,
//		0x1, 0x1, 0x5, 0x0, 0x3, 0x81, 0x8d, 0x0, 0x30, 0x81, 0x89, 0x2,
//		0x81, 0x81, 0x0, 0xda, 0x57, 0xa6, 0x93, 0x9f, 0x36, 0x3c, 0x69, 0xd2,
//		0x53, 0x43, 0x64, 0xe2, 0x95, 0xa3, 0x48, 0xc3, 0xb7, 0x5, 0x81, 0x31,
//		0x3e, 0x55, 0x55, 0x83, 0x6d, 0x19, 0x10, 0xcf, 0x1c, 0x11, 0xcd, 0x1b,
//		0x2b, 0x45, 0x65, 0x91, 0x6a, 0xd5, 0x54, 0x63, 0x44, 0x9d, 0x37, 0x69,
//		0x2c, 0xf7, 0x49, 0xc4, 0xb2, 0xcf, 0x32, 0x83, 0x14, 0x5b, 0x3a, 0x8e,
//		0x41, 0xd9, 0x7f, 0xdf, 0xff, 0x1f, 0x56, 0x88, 0x9f, 0x33, 0x9, 0xd5,
//		0xb3, 0x67, 0x10, 0xd8, 0x9, 0x28, 0x6d, 0xb6, 0xed, 0x4d, 0xe9, 0xee,
//		0x96, 0x42, 0x26, 0xe7, 0x9c, 0x90, 0x4e, 0x37, 0x7d, 0x4a, 0xad, 0xdd,
//		0x9e, 0xdf, 0x86, 0xd8, 0x4b, 0x8b, 0xb9, 0x33, 0xd3, 0xdb, 0xa8, 0x3f,
//		0xd7, 0xb2, 0x6d, 0xb9, 0xbd, 0x9d, 0xbd, 0x8a, 0xd9, 0x6b, 0xf8, 0xa6,
//		0xcb, 0x5c, 0x9f, 0x5c, 0xb1, 0x60, 0xc8, 0xb, 0xd5, 0x7b, 0x8f, 0x2,
//		0x3, 0x1, 0x0, 0x1, 0xa3, 0x60, 0x30, 0x5e, 0x30, 0xe, 0x6, 0x3,
//		0x55, 0x1d, 0xf, 0x1, 0x1, 0xff, 0x4, 0x4, 0x3, 0x2, 0x3, 0xb8,
//		0x30, 0xc, 0x6, 0x3, 0x55, 0x1d, 0x13, 0x1, 0x1, 0xff, 0x4, 0x2,
//		0x30, 0x0, 0x30, 0x1d, 0x6, 0x3, 0x55, 0x1d, 0xe, 0x4, 0x16, 0x4,
//		0x14, 0x51, 0x99, 0xa3, 0xe1, 0xff, 0xb, 0xf2, 0xf2, 0xa5, 0xc0, 0x4b,
//		0xee, 0x22, 0x64, 0xe6, 0x31, 0x89, 0x7f, 0x16, 0xba, 0x30, 0x1f, 0x6,
//		0x3, 0x55, 0x1d, 0x23, 0x4, 0x18, 0x30, 0x16, 0x80, 0x14, 0xff, 0x4b,
//		0x1a, 0x43, 0x9a, 0xf5, 0x19, 0x96, 0xab, 0x18, 0x0, 0x2b, 0x61, 0xc9,
//		0xee, 0x40, 0x9d, 0x8e, 0xc7, 0x4, 0x30, 0xd, 0x6, 0x9, 0x2a, 0x86,
//		0x48, 0x86, 0xf7, 0xd, 0x1, 0x1, 0x5, 0x5, 0x0, 0x3, 0x82, 0x1,
//		0x1, 0x0, 0x9f, 0xb4, 0xd1, 0x63, 0x56, 0x28, 0xf5, 0xf1, 0xf1, 0x2e,
//		0x14, 0x8, 0xfa, 0x30, 0x58, 0xb2, 0xd, 0xe3, 0x71, 0x71, 0xa0, 0xbf,
//		0x55, 0xa9, 0xb6, 0x4d, 0xb7, 0x3, 0xa8, 0x6a, 0xae, 0x45, 0x69, 0x6a,
//		0x65, 0x5c, 0x21, 0xb8, 0xf1, 0x93, 0x84, 0x15, 0x10, 0x77, 0x7e, 0xfb,
//		0x7a, 0x65, 0xcc, 0xb8, 0x97, 0x6c, 0xcf, 0x9, 0xc0, 0x35, 0xf5, 0xd7,
//		0x6d, 0x8c, 0xa3, 0x57, 0xdb, 0xac, 0x1a, 0xc5, 0xed, 0xdf, 0xdb, 0xf6,
//		0x8d, 0xf, 0x1b, 0x2f, 0x9, 0x20, 0x88, 0xd0, 0x73, 0x53, 0xa8, 0xfc,
//		0xbc, 0x26, 0x80, 0x7, 0x92, 0xe9, 0xef, 0xc3, 0x7b, 0xfd, 0x63, 0x96,
//		0xd8, 0x8c, 0x66, 0xc, 0xa9, 0x87, 0xca, 0xa4, 0x92, 0x2d, 0xaf, 0x26,
//		0xd6, 0x3, 0xec, 0xb5, 0xf, 0x87, 0x7f, 0xba, 0xc3, 0x41, 0xd1, 0x1f,
//		0xfa, 0xc2, 0xd7, 0x5f, 0xae, 0xd9, 0x48, 0xcb, 0x9e, 0x2c, 0x76, 0x92,
//		0x91, 0x2f, 0xa4, 0xbf, 0x97, 0x40, 0x8, 0x6e, 0xe0, 0x30, 0xb, 0xc7,
//		0xe5, 0x58, 0x8f, 0xf2, 0x9d, 0xd9, 0x95, 0x3, 0x83, 0x8, 0xbf, 0x90,
//		0xb3, 0x41, 0x8f, 0xef, 0x3d, 0xd6, 0xaf, 0x6, 0x78, 0xce, 0x18, 0x7c,
//		0x41, 0xc3, 0x95, 0x74, 0xde, 0x2a, 0x6, 0xd8, 0xf8, 0x8f, 0xa9, 0x84,
//		0xa6, 0xc9, 0x11, 0xeb, 0x24, 0x9b, 0x7a, 0x31, 0x39, 0xa6, 0xf6, 0x20,
//		0x59, 0xce, 0xc, 0x2d, 0x6c, 0x87, 0x64, 0xbe, 0x53, 0x46, 0x71, 0xd0,
//		0xcf, 0x7b, 0x7d, 0xcd, 0xdb, 0x68, 0x39, 0xa7, 0xa8, 0xec, 0xc4, 0xb1,
//		0x80, 0x73, 0xd2, 0x6, 0x12, 0x21, 0x82, 0x7f, 0x45, 0x3f, 0x87, 0xf0,
//		0x1e, 0xeb, 0x94, 0x41, 0x81, 0xe2, 0x57, 0x8d, 0x87, 0xd9, 0x24, 0x6f,
//		0x9, 0x70, 0x12, 0xba, 0xf5, 0x90, 0xd5, 0x89, 0x67, 0x67, 0x1b, 0xa3,
//		0x8c, 0x49, 0x52, 0x29, 0x3c, 0xec, 0xa1, 0x0, 0x31, 0x0
//};

// obtained from my Python script (cert_id = 0)
//but part A is reversed and part B is reversed
//const uint8_t AM0_CERT_DATA[] = {
//		0x8A, 0xBD, 0x9D, 0xBD, 0xB9, 0x6D, 0xB2, 0xD7, 0x3F, 0xA8,
//		0xDB, 0xD3, 0x33, 0xB9, 0x8B, 0x4B, 0xD8, 0x86, 0xDF, 0x9E,
//		0xDD, 0xAD, 0x4A, 0x7D, 0x37, 0x4E, 0x90, 0x9C, 0xE7, 0x26,
//		0x42, 0x96, 0xEE, 0xE9, 0x4D, 0xED, 0xB6, 0x6D, 0x28, 0x09,
//		0xD8, 0x10, 0x67, 0xB3, 0xD5, 0x09, 0x33, 0x9F, 0x88, 0x56,
//		0x1F, 0xFF, 0xDF, 0x7F, 0xD9, 0x41, 0x8E, 0x3A, 0x5B, 0x14,
//		0x83, 0x32, 0xCF, 0xB2, 0xC4, 0x49, 0xF7, 0x2C, 0x69, 0x37,
//		0x9D, 0x44, 0x63, 0x54, 0xD5, 0x6A, 0x91, 0x65, 0x45, 0x2B,
//		0x1B, 0xCD, 0x11, 0x1C, 0xCF, 0x10, 0x19, 0x6D, 0x83, 0x55,
//		0x55, 0x3E, 0x31, 0x81, 0x05, 0xB7, 0xC3, 0x48, 0xA3, 0x95,
//		0xE2, 0x64, 0x43, 0x53, 0xD2, 0x69, 0x3C, 0x36, 0x9F, 0x93,
//		0xA6, 0x57, 0xDA, 0x00, 0x81, 0x81, 0x02, 0x89, 0x81, 0x30,
//		0x00, 0x8D, 0x81, 0x03, 0x00, 0x05, 0x01, 0x01, 0x01, 0x0D,
//		0xF7, 0x86, 0x48, 0x86, 0x2A, 0x09, 0x06, 0x0D, 0x30, 0x9F,
//		0x81, 0x30, 0x31, 0x30, 0x30, 0x30, 0x30, 0x30, 0x41, 0x41,
//		0x33, 0x30, 0x30, 0x30, 0x41, 0x41, 0x42, 0x30, 0x41, 0x41,
//		0x38, 0x30, 0x35, 0x30, 0x34, 0x31, 0x41, 0x41, 0x33, 0x33,
//		0x33, 0x33, 0x5F, 0x41, 0x50, 0x49, 0x22, 0x14, 0x03, 0x04,
//		0x55, 0x03, 0x06, 0x29, 0x30, 0x2B, 0x31, 0x73, 0x65, 0x69,
//		0x72, 0x6F, 0x73, 0x73, 0x65, 0x63, 0x63, 0x41, 0x20, 0x64,
//		0x6F, 0x50, 0x69, 0x20, 0x65, 0x6C, 0x70, 0x70, 0x41, 0x16,
//		0x13, 0x0B, 0x04, 0x55, 0x03, 0x06, 0x1D, 0x30, 0x1F, 0x31,
//		0x2E, 0x63, 0x6E, 0x49, 0x20, 0x65, 0x6C, 0x70, 0x70, 0x41,
//		0x0A, 0x13, 0x0A, 0x04, 0x55, 0x03, 0x06, 0x11, 0x30, 0x13,
//		0x31, 0x53, 0x55, 0x02, 0x13, 0x06, 0x04, 0x55, 0x03, 0x06,
//		0x09, 0x30, 0x0B, 0x31, 0x70, 0x30, 0x5A, 0x34, 0x35, 0x33,
//		0x30, 0x31, 0x30, 0x38, 0x30, 0x35, 0x30, 0x32, 0x32, 0x0D,
//		0x17, 0x5A, 0x34, 0x35, 0x33, 0x30, 0x31, 0x30, 0x38, 0x30,
//		0x35, 0x30, 0x34, 0x31, 0x0D, 0x17, 0x1E, 0x30, 0x79, 0x74,
//		0x69, 0x72, 0x6F, 0x68, 0x74, 0x75, 0x41, 0x20, 0x6E, 0x6F,
//		0x69, 0x74, 0x61, 0x63, 0x69, 0x66, 0x69, 0x74, 0x72, 0x65,
//		0x43, 0x20, 0x73, 0x65, 0x69, 0x72, 0x6F, 0x73, 0x73, 0x65,
//		0x63, 0x63, 0x41, 0x20, 0x64, 0x6F, 0x50, 0x69, 0x20, 0x65,
//		0x6C, 0x70, 0x70, 0x41, 0x2E, 0x13, 0x03, 0x04, 0x55, 0x03,
//		0x06, 0x35, 0x30, 0x37, 0x31, 0x79, 0x74, 0x69, 0x72, 0x6F,
//		0x68, 0x74, 0x75, 0x41, 0x20, 0x6E, 0x6F, 0x69, 0x74, 0x61,
//		0x63, 0x69, 0x66, 0x69, 0x74, 0x72, 0x65, 0x43, 0x20, 0x65,
//		0x6C, 0x70, 0x70, 0x41, 0x1D, 0x13, 0x0B, 0x04, 0x55, 0x03,
//		0x06, 0x24, 0x30, 0x26, 0x31, 0x2E, 0x63, 0x6E, 0x49, 0x20,
//		0x65, 0x6C, 0x70, 0x70, 0x41, 0x0A, 0x13, 0x0A, 0x04, 0x55,
//		0x03, 0x06, 0x11, 0x30, 0x13, 0x31, 0x53, 0x55, 0x02, 0x13,
//		0x06, 0x04, 0x55, 0x03, 0x06, 0x09, 0x30, 0x0B, 0x31, 0x83,
//		0x81, 0x30, 0x00, 0x05, 0x05, 0x01, 0x01, 0x0D, 0xF7, 0x86,
//		0x48, 0x86, 0x2A, 0x09, 0x06, 0x0D, 0x30, 0x01, 0x00, 0x00,
//		0xAA, 0x03, 0x00, 0xAA, 0x0B, 0xAA, 0x08, 0x05, 0x14, 0xAA,
//		0x33, 0x33, 0x0F, 0x02, 0x02, 0x01, 0x02, 0x03, 0xA0, 0x41,
//		0x02, 0x82, 0x30, 0x59, 0x03, 0x82, 0x30, 0x5D, 0x03, 0x82,
//		0xA0, 0x01, 0x07, 0x01, 0x0D, 0xF7, 0x86, 0x48, 0x86, 0x2A,
//		0x09, 0x06, 0x0B, 0x30, 0x00, 0x31, 0x01, 0x01, 0x02, 0x77,
//		0x03, 0x82, 0x30, 0x7B, 0x03, 0x82, 0xA0, 0x02, 0x07, 0x01,
//		0x0D, 0xF7, 0x86, 0x48, 0x86, 0x2A, 0x09, 0x06, 0x8A, 0x03,
//		0x82, 0x30,
//		0x00, 0x31, 0x00, 0xA1, 0xEC, 0x3C, 0x29, 0x52, 0x49, 0x8C,
//		0xA3, 0x1B, 0x67, 0x67, 0x89, 0xD5, 0x90, 0xF5, 0xBA, 0x12,
//		0x70, 0x09, 0x6F, 0x24, 0xD9, 0x87, 0x8D, 0x57, 0xE2, 0x81,
//		0x41, 0x94, 0xEB, 0x1E, 0xF0, 0x87, 0x3F, 0x45, 0x7F, 0x82,
//		0x21, 0x12, 0x06, 0xD2, 0x73, 0x80, 0xB1, 0xC4, 0xEC, 0xA8,
//		0xA7, 0x39, 0x68, 0xDB, 0xCD, 0x7D, 0x7B, 0xCF, 0xD0, 0x71,
//		0x46, 0x53, 0xBE, 0x64, 0x87, 0x6C, 0x2D, 0x0C, 0xCE, 0x59,
//		0x20, 0xF6, 0xA6, 0x39, 0x31, 0x7A, 0x9B, 0x24, 0xEB, 0x11,
//		0xC9, 0xA6, 0x84, 0xA9, 0x8F, 0xF8, 0xD8, 0x06, 0x2A, 0xDE,
//		0x74, 0x95, 0xC3, 0x41, 0x7C, 0x18, 0xCE, 0x78, 0x06, 0xAF,
//		0xD6, 0x3D, 0xEF, 0x8F, 0x41, 0xB3, 0x90, 0xBF, 0x08, 0x83,
//		0x03, 0x95, 0xD9, 0x9D, 0xF2, 0x8F, 0x58, 0xE5, 0xC7, 0x0B,
//		0x30, 0xE0, 0x6E, 0x08, 0x40, 0x97, 0xBF, 0xA4, 0x2F, 0x91,
//		0x92, 0x76, 0x2C, 0x9E, 0xCB, 0x48, 0xD9, 0xAE, 0x5F, 0xD7,
//		0xC2, 0xFA, 0x1F, 0xD1, 0x41, 0xC3, 0xBA, 0x7F, 0x87, 0x0F,
//		0xB5, 0xEC, 0x03, 0xD6, 0x26, 0xAF, 0x2D, 0x92, 0xA4, 0xCA,
//		0x87, 0xA9, 0x0C, 0x66, 0x8C, 0xD8, 0x96, 0x63, 0xFD, 0x7B,
//		0xC3, 0xEF, 0xE9, 0x92, 0x07, 0x80, 0x26, 0xBC, 0xFC, 0xA8,
//		0x53, 0x73, 0xD0, 0x88, 0x20, 0x09, 0x2F, 0x1B, 0x0F, 0x8D,
//		0xF6, 0xDB, 0xDF, 0xED, 0xC5, 0x1A, 0xAC, 0xDB, 0x57, 0xA3,
//		0x8C, 0x6D, 0xD7, 0xF5, 0x35, 0xC0, 0x09, 0xCF, 0x6C, 0x97,
//		0xB8, 0xCC, 0x65, 0x7A, 0xFB, 0x7E, 0x77, 0x10, 0x15, 0x84,
//		0x93, 0xF1, 0xB8, 0x21, 0x5C, 0x65, 0x6A, 0x69, 0x45, 0xAE,
//		0x6A, 0xA8, 0x03, 0xB7, 0x4D, 0xB6, 0xA9, 0x55, 0xBF, 0xA0,
//		0x71, 0x71, 0xE3, 0x0D, 0xB2, 0x58, 0x30, 0xFA, 0x08, 0x14,
//		0x2E, 0xF1, 0xF1, 0xF5, 0x28, 0x56, 0x63, 0xD1, 0xB4, 0x9F,
//		0x00, 0x01, 0x01, 0x82, 0x03, 0x00, 0x05, 0x05, 0x01, 0x01,
//		0x0D, 0xF7, 0x86, 0x48, 0x86, 0x2A, 0x09, 0x06, 0x0D, 0x30,
//		0x04, 0xC7, 0x8E, 0x9D, 0x40, 0xEE, 0xC9, 0x61, 0x2B, 0x00,
//		0x18, 0xAB, 0x96, 0x19, 0xF5, 0x9A, 0x43, 0x1A, 0x4B, 0xFF,
//		0x14, 0x80, 0x16, 0x30, 0x18, 0x04, 0x23, 0x1D, 0x55, 0x03,
//		0x06, 0x1F, 0x30, 0xBA, 0x16, 0x7F, 0x89, 0x31, 0xE6, 0x64,
//		0x22, 0xEE, 0x4B, 0xC0, 0xA5, 0xF2, 0xF2, 0x0B, 0xFF, 0xE1,
//		0xA3, 0x99, 0x51, 0x14, 0x04, 0x16, 0x04, 0x0E, 0x1D, 0x55,
//		0x03, 0x06, 0x1D, 0x30, 0x00, 0x30, 0x02, 0x04, 0xFF, 0x01,
//		0x01, 0x13, 0x1D, 0x55, 0x03, 0x06, 0x0C, 0x30, 0xB8, 0x03,
//		0x02, 0x03, 0x04, 0x04, 0xFF, 0x01, 0x01, 0x0F, 0x1D, 0x55,
//		0x03, 0x06, 0x0E, 0x30, 0x5E, 0x30, 0x60, 0xA3, 0x01, 0x00,
//		0x01, 0x03, 0x02, 0x8F, 0x7B, 0xD5, 0x0B, 0xC8, 0x60, 0xB1,
//		0x5C, 0x9F, 0x5C, 0xCB, 0xA6, 0xF8, 0x6B, 0xD9
//};


// from SWAUTH_CLASS_0B-3333-2014-05-08-BATCH_0003-COUNT_5_0_cert.c
//const uint8_t AM0_CERT_DATA[] = {
//		  0x30, 0x82, 0x03, 0x8a, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d,
//		  0x01, 0x07, 0x02, 0xa0, 0x82, 0x03, 0x7b, 0x30, 0x82, 0x03, 0x77, 0x02,
//		  0x01, 0x01, 0x31, 0x00, 0x30, 0x0b, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86,
//		  0xf7, 0x0d, 0x01, 0x07, 0x01, 0xa0, 0x82, 0x03, 0x5d, 0x30, 0x82, 0x03,
//		  0x59, 0x30, 0x82, 0x02, 0x41, 0xa0, 0x03, 0x02, 0x01, 0x02, 0x02, 0x0f,
//		  0x33, 0x33, 0xaa, 0x14, 0x05, 0x08, 0xaa, 0x0b, 0xaa, 0x00, 0x03, 0xaa,
//		  0x00, 0x00, 0x01, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7,
//		  0x0d, 0x01, 0x01, 0x05, 0x05, 0x00, 0x30, 0x81, 0x83, 0x31, 0x0b, 0x30,
//		  0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x55, 0x53, 0x31, 0x13,
//		  0x30, 0x11, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13, 0x0a, 0x41, 0x70, 0x70,
//		  0x6c, 0x65, 0x20, 0x49, 0x6e, 0x63, 0x2e, 0x31, 0x26, 0x30, 0x24, 0x06,
//		  0x03, 0x55, 0x04, 0x0b, 0x13, 0x1d, 0x41, 0x70, 0x70, 0x6c, 0x65, 0x20,
//		  0x43, 0x65, 0x72, 0x74, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x69, 0x6f,
//		  0x6e, 0x20, 0x41, 0x75, 0x74, 0x68, 0x6f, 0x72, 0x69, 0x74, 0x79, 0x31,
//		  0x37, 0x30, 0x35, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x2e, 0x41, 0x70,
//		  0x70, 0x6c, 0x65, 0x20, 0x69, 0x50, 0x6f, 0x64, 0x20, 0x41, 0x63, 0x63,
//		  0x65, 0x73, 0x73, 0x6f, 0x72, 0x69, 0x65, 0x73, 0x20, 0x43, 0x65, 0x72,
//		  0x74, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x20, 0x41,
//		  0x75, 0x74, 0x68, 0x6f, 0x72, 0x69, 0x74, 0x79, 0x30, 0x1e, 0x17, 0x0d,
//		  0x31, 0x34, 0x30, 0x35, 0x30, 0x38, 0x30, 0x31, 0x30, 0x33, 0x35, 0x34,
//		  0x5a, 0x17, 0x0d, 0x32, 0x32, 0x30, 0x35, 0x30, 0x38, 0x30, 0x31, 0x30,
//		  0x33, 0x35, 0x34, 0x5a, 0x30, 0x70, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03,
//		  0x55, 0x04, 0x06, 0x13, 0x02, 0x55, 0x53, 0x31, 0x13, 0x30, 0x11, 0x06,
//		  0x03, 0x55, 0x04, 0x0a, 0x13, 0x0a, 0x41, 0x70, 0x70, 0x6c, 0x65, 0x20,
//		  0x49, 0x6e, 0x63, 0x2e, 0x31, 0x1f, 0x30, 0x1d, 0x06, 0x03, 0x55, 0x04,
//		  0x0b, 0x13, 0x16, 0x41, 0x70, 0x70, 0x6c, 0x65, 0x20, 0x69, 0x50, 0x6f,
//		  0x64, 0x20, 0x41, 0x63, 0x63, 0x65, 0x73, 0x73, 0x6f, 0x72, 0x69, 0x65,
//		  0x73, 0x31, 0x2b, 0x30, 0x29, 0x06, 0x03, 0x55, 0x04, 0x03, 0x14, 0x22,
//		  0x49, 0x50, 0x41, 0x5f, 0x33, 0x33, 0x33, 0x33, 0x41, 0x41, 0x31, 0x34,
//		  0x30, 0x35, 0x30, 0x38, 0x41, 0x41, 0x30, 0x42, 0x41, 0x41, 0x30, 0x30,
//		  0x30, 0x33, 0x41, 0x41, 0x30, 0x30, 0x30, 0x30, 0x30, 0x31, 0x30, 0x81,
//		  0x9f, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01,
//		  0x01, 0x01, 0x05, 0x00, 0x03, 0x81, 0x8d, 0x00, 0x30, 0x81, 0x89, 0x02,
//		  0x81, 0x81, 0x00, 0xda, 0x57, 0xa6, 0x93, 0x9f, 0x36, 0x3c, 0x69, 0xd2,
//		  0x53, 0x43, 0x64, 0xe2, 0x95, 0xa3, 0x48, 0xc3, 0xb7, 0x05, 0x81, 0x31,
//		  0x3e, 0x55, 0x55, 0x83, 0x6d, 0x19, 0x10, 0xcf, 0x1c, 0x11, 0xcd, 0x1b,
//		  0x2b, 0x45, 0x65, 0x91, 0x6a, 0xd5, 0x54, 0x63, 0x44, 0x9d, 0x37, 0x69,
//		  0x2c, 0xf7, 0x49, 0xc4, 0xb2, 0xcf, 0x32, 0x83, 0x14, 0x5b, 0x3a, 0x8e,
//		  0x41, 0xd9, 0x7f, 0xdf, 0xff, 0x1f, 0x56, 0x88, 0x9f, 0x33, 0x09, 0xd5,
//		  0xb3, 0x67, 0x10, 0xd8, 0x09, 0x28, 0x6d, 0xb6, 0xed, 0x4d, 0xe9, 0xee,
//		  0x96, 0x42, 0x26, 0xe7, 0x9c, 0x90, 0x4e, 0x37, 0x7d, 0x4a, 0xad, 0xdd,
//		  0x9e, 0xdf, 0x86, 0xd8, 0x4b, 0x8b, 0xb9, 0x33, 0xd3, 0xdb, 0xa8, 0x3f,
//		  0xd7, 0xb2, 0x6d, 0xb9, 0xbd, 0x9d, 0xbd, 0x8a, 0xd9, 0x6b, 0xf8, 0xa6,
//		  0xcb, 0x5c, 0x9f, 0x5c, 0xb1, 0x60, 0xc8, 0x0b, 0xd5, 0x7b, 0x8f, 0x02,
//		  0x03, 0x01, 0x00, 0x01, 0xa3, 0x60, 0x30, 0x5e, 0x30, 0x0e, 0x06, 0x03,
//		  0x55, 0x1d, 0x0f, 0x01, 0x01, 0xff, 0x04, 0x04, 0x03, 0x02, 0x03, 0xb8,
//		  0x30, 0x0c, 0x06, 0x03, 0x55, 0x1d, 0x13, 0x01, 0x01, 0xff, 0x04, 0x02,
//		  0x30, 0x00, 0x30, 0x1d, 0x06, 0x03, 0x55, 0x1d, 0x0e, 0x04, 0x16, 0x04,
//		  0x14, 0x51, 0x99, 0xa3, 0xe1, 0xff, 0x0b, 0xf2, 0xf2, 0xa5, 0xc0, 0x4b,
//		  0xee, 0x22, 0x64, 0xe6, 0x31, 0x89, 0x7f, 0x16, 0xba, 0x30, 0x1f, 0x06,
//		  0x03, 0x55, 0x1d, 0x23, 0x04, 0x18, 0x30, 0x16, 0x80, 0x14, 0xff, 0x4b,
//		  0x1a, 0x43, 0x9a, 0xf5, 0x19, 0x96, 0xab, 0x18, 0x00, 0x2b, 0x61, 0xc9,
//		  0xee, 0x40, 0x9d, 0x8e, 0xc7, 0x04, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86,
//		  0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x05, 0x05, 0x00, 0x03, 0x82, 0x01,
//		  0x01, 0x00, 0x9f, 0xb4, 0xd1, 0x63, 0x56, 0x28, 0xf5, 0xf1, 0xf1, 0x2e,
//		  0x14, 0x08, 0xfa, 0x30, 0x58, 0xb2, 0x0d, 0xe3, 0x71, 0x71, 0xa0, 0xbf,
//		  0x55, 0xa9, 0xb6, 0x4d, 0xb7, 0x03, 0xa8, 0x6a, 0xae, 0x45, 0x69, 0x6a,
//		  0x65, 0x5c, 0x21, 0xb8, 0xf1, 0x93, 0x84, 0x15, 0x10, 0x77, 0x7e, 0xfb,
//		  0x7a, 0x65, 0xcc, 0xb8, 0x97, 0x6c, 0xcf, 0x09, 0xc0, 0x35, 0xf5, 0xd7,
//		  0x6d, 0x8c, 0xa3, 0x57, 0xdb, 0xac, 0x1a, 0xc5, 0xed, 0xdf, 0xdb, 0xf6,
//		  0x8d, 0x0f, 0x1b, 0x2f, 0x09, 0x20, 0x88, 0xd0, 0x73, 0x53, 0xa8, 0xfc,
//		  0xbc, 0x26, 0x80, 0x07, 0x92, 0xe9, 0xef, 0xc3, 0x7b, 0xfd, 0x63, 0x96,
//		  0xd8, 0x8c, 0x66, 0x0c, 0xa9, 0x87, 0xca, 0xa4, 0x92, 0x2d, 0xaf, 0x26,
//		  0xd6, 0x03, 0xec, 0xb5, 0x0f, 0x87, 0x7f, 0xba, 0xc3, 0x41, 0xd1, 0x1f,
//		  0xfa, 0xc2, 0xd7, 0x5f, 0xae, 0xd9, 0x48, 0xcb, 0x9e, 0x2c, 0x76, 0x92,
//		  0x91, 0x2f, 0xa4, 0xbf, 0x97, 0x40, 0x08, 0x6e, 0xe0, 0x30, 0x0b, 0xc7,
//		  0xe5, 0x58, 0x8f, 0xf2, 0x9d, 0xd9, 0x95, 0x03, 0x83, 0x08, 0xbf, 0x90,
//		  0xb3, 0x41, 0x8f, 0xef, 0x3d, 0xd6, 0xaf, 0x06, 0x78, 0xce, 0x18, 0x7c,
//		  0x41, 0xc3, 0x95, 0x74, 0xde, 0x2a, 0x06, 0xd8, 0xf8, 0x8f, 0xa9, 0x84,
//		  0xa6, 0xc9, 0x11, 0xeb, 0x24, 0x9b, 0x7a, 0x31, 0x39, 0xa6, 0xf6, 0x20,
//		  0x59, 0xce, 0x0c, 0x2d, 0x6c, 0x87, 0x64, 0xbe, 0x53, 0x46, 0x71, 0xd0,
//		  0xcf, 0x7b, 0x7d, 0xcd, 0xdb, 0x68, 0x39, 0xa7, 0xa8, 0xec, 0xc4, 0xb1,
//		  0x80, 0x73, 0xd2, 0x06, 0x12, 0x21, 0x82, 0x7f, 0x45, 0x3f, 0x87, 0xf0,
//		  0x1e, 0xeb, 0x94, 0x41, 0x81, 0xe2, 0x57, 0x8d, 0x87, 0xd9, 0x24, 0x6f,
//		  0x09, 0x70, 0x12, 0xba, 0xf5, 0x90, 0xd5, 0x89, 0x67, 0x67, 0x1b, 0xa3,
//		  0x8c, 0x49, 0x52, 0x29, 0x3c, 0xec, 0xa1, 0x00, 0x31, 0x00
//		};

////////////////////////////////////////////////////////////////////////////////////////
// The private key (320 bytes = 5 x 64 bytes)
// obtained from CEVA (cert_id = 0)


////////////////////////////////////////////////////////////////////////////////////////
// The private key from MFI portal (320 bytes = 5 x 64 bytes)
// obtained from my Python script (cert_id = 0)
//const uint8_t AM0_CERT_PRIV_KEY[] = {
//		0xf8, 0xa0, 0x11, 0x7e, 0x4, 0xff, 0xbf, 0x6f, 0xeb, 0x3c, 0x20, 0x13,
//		0x99, 0x5a, 0x64, 0xc9, 0xfb, 0xe8, 0xe3, 0x3, 0xe8, 0xc9, 0x81, 0x85,
//		0x60, 0x4a, 0x10, 0x92, 0xf2, 0x70, 0x25, 0x7d, 0x35, 0xa1, 0x5a, 0x95,
//		0xab, 0x41, 0x50, 0x77, 0x1e, 0xcf, 0x12, 0x5c, 0xee, 0xde, 0x5, 0x7,
//		0x48, 0x2f, 0xef, 0x3, 0x95, 0xa3, 0x2f, 0x71, 0xd4, 0xb2, 0xad, 0xfc,
//		0x64, 0x2c, 0xbd, 0xf3, 0xe0, 0xd1, 0xa1, 0x3c, 0x23, 0x75, 0x85, 0xbc,
//		0xa3, 0x95, 0x29, 0xc4, 0xe2, 0x2e, 0xc0, 0x4b, 0xe5, 0x39, 0x34, 0xa1,
//		0xd6, 0x6e, 0x61, 0xc2, 0x87, 0xb7, 0x87, 0x4b, 0x0, 0x22, 0xc, 0x76,
//		0x76, 0x5c, 0x7e, 0x74, 0x18, 0xe8, 0xc9, 0xc2, 0x36, 0x15, 0x83, 0x9d,
//		0xf4, 0x1c, 0xce, 0x9e, 0xa1, 0xd4, 0x2, 0xa6, 0x86, 0x6f, 0x5f, 0x65,
//		0x3a, 0xa8, 0xad, 0x4c, 0x31, 0x30, 0x6, 0xf5, 0xcb, 0xbd, 0x18, 0x38,
//		0x85, 0xce, 0x32, 0x49, 0x7b, 0xa2, 0x4c, 0xc2, 0xe2, 0xd3, 0x51, 0x6e,
//		0xb7, 0xd1, 0x33, 0x5f, 0x3b, 0xbf, 0xd, 0x35, 0x88, 0x1f, 0x89, 0x8f,
//		0x71, 0xbe, 0x76, 0xea, 0x31, 0x2d, 0xa5, 0x76, 0xaa, 0xdd, 0x1e, 0x1c,
//		0x4f, 0x91, 0xef, 0x1, 0x5a, 0xf9, 0x73, 0x73, 0x71, 0x33, 0x5e, 0x91,
//		0x38, 0x69, 0x7e, 0x72, 0xb0, 0x93, 0x2f, 0xc2, 0x79, 0x30, 0xb5, 0x3,
//		0x68, 0x4e, 0x1a, 0x26, 0x52, 0xb5, 0x45, 0xd5, 0x1d, 0x78, 0x29, 0x26,
//		0xe5, 0x61, 0x97, 0x6a, 0x1e, 0xf1, 0x89, 0x8f, 0xc4, 0x72, 0xf5, 0xfc,
//		0x51, 0x7, 0x3f, 0x47, 0xf6, 0xc9, 0xd5, 0x4a, 0x68, 0xe3, 0xc4, 0xef,
//		0x8c, 0x57, 0x4, 0xb4, 0x8c, 0x6f, 0x32, 0xdf, 0x67, 0xd0, 0xad, 0xb4,
//		0x3f, 0x94, 0xa3, 0x9e, 0x2b, 0x25, 0x24, 0xf7, 0x4c, 0x5d, 0xd1, 0xf9,
//		0x55, 0xa0, 0xd8, 0xb9, 0x4, 0x74, 0x6f, 0x1a, 0xa7, 0x2f, 0x6c, 0x40,
//		0x98, 0x92, 0xb8, 0x3e, 0x91, 0xec, 0xd7, 0x84, 0x14, 0xbe, 0xe8, 0x87,
//		0xaa, 0x5, 0x30, 0x71, 0x2e, 0xee, 0x4, 0xd, 0xce, 0xe2, 0xdd, 0x97,
//		0xfd, 0x90, 0x48, 0x54, 0xbd, 0x6f, 0x4, 0x60, 0x1e, 0x92, 0x2c, 0xfc,
//		0x79, 0x5b, 0x19, 0x21, 0x79, 0x94, 0x56, 0x29, 0xf2, 0xc9, 0xac, 0x46,
//		0xe2, 0x8d, 0x81, 0x5, 0xe0, 0x23, 0x76, 0x66
//};

// from SWAUTH_CLASS_0B-3333-2014-05-08-BATCH_0003-COUNT_5_0_priv.c
// (608 bytes = 9.5 x 64 bytes)
//const uint8_t AM0_CERT_PRIV_KEY[] = {
//		  0x30, 0x82, 0x02, 0x5c, 0x02, 0x01, 0x00, 0x02, 0x81, 0x81, 0x00, 0xda,
//		  0x57, 0xa6, 0x93, 0x9f, 0x36, 0x3c, 0x69, 0xd2, 0x53, 0x43, 0x64, 0xe2,
//		  0x95, 0xa3, 0x48, 0xc3, 0xb7, 0x05, 0x81, 0x31, 0x3e, 0x55, 0x55, 0x83,
//		  0x6d, 0x19, 0x10, 0xcf, 0x1c, 0x11, 0xcd, 0x1b, 0x2b, 0x45, 0x65, 0x91,
//		  0x6a, 0xd5, 0x54, 0x63, 0x44, 0x9d, 0x37, 0x69, 0x2c, 0xf7, 0x49, 0xc4,
//		  0xb2, 0xcf, 0x32, 0x83, 0x14, 0x5b, 0x3a, 0x8e, 0x41, 0xd9, 0x7f, 0xdf,
//		  0xff, 0x1f, 0x56, 0x88, 0x9f, 0x33, 0x09, 0xd5, 0xb3, 0x67, 0x10, 0xd8,
//		  0x09, 0x28, 0x6d, 0xb6, 0xed, 0x4d, 0xe9, 0xee, 0x96, 0x42, 0x26, 0xe7,
//		  0x9c, 0x90, 0x4e, 0x37, 0x7d, 0x4a, 0xad, 0xdd, 0x9e, 0xdf, 0x86, 0xd8,
//		  0x4b, 0x8b, 0xb9, 0x33, 0xd3, 0xdb, 0xa8, 0x3f, 0xd7, 0xb2, 0x6d, 0xb9,
//		  0xbd, 0x9d, 0xbd, 0x8a, 0xd9, 0x6b, 0xf8, 0xa6, 0xcb, 0x5c, 0x9f, 0x5c,
//		  0xb1, 0x60, 0xc8, 0x0b, 0xd5, 0x7b, 0x8f, 0x02, 0x03, 0x01, 0x00, 0x01,
//		  0x02, 0x81, 0x80, 0x67, 0xf1, 0x38, 0x24, 0xa8, 0xb3, 0xaa, 0x18, 0xfa,
//		  0x7e, 0x96, 0xe3, 0xcd, 0x16, 0x4d, 0x70, 0x53, 0x73, 0xaa, 0x94, 0x31,
//		  0x3c, 0x2a, 0x65, 0x96, 0x36, 0x76, 0xab, 0x50, 0xdd, 0x5d, 0x00, 0x16,
//		  0x82, 0x07, 0xfc, 0x6d, 0x38, 0xbd, 0xab, 0xf9, 0xc1, 0xed, 0x52, 0x36,
//		  0xa8, 0xa8, 0x64, 0x9e, 0xd6, 0x3c, 0xdb, 0x20, 0x19, 0xad, 0xc0, 0x77,
//		  0x7e, 0x93, 0xab, 0x53, 0x98, 0x61, 0x72, 0xf0, 0x1e, 0x2a, 0x2a, 0x44,
//		  0x20, 0x03, 0x04, 0x69, 0x72, 0xc6, 0x6c, 0xa6, 0xa4, 0x6c, 0xe7, 0x5e,
//		  0x2c, 0x42, 0x1b, 0xd0, 0x7d, 0xf4, 0xfc, 0xbf, 0x13, 0xf5, 0x31, 0x14,
//		  0x05, 0xaa, 0x10, 0x19, 0x14, 0x38, 0x0f, 0x5a, 0x8a, 0x26, 0xc2, 0xc5,
//		  0xe8, 0xcc, 0x4f, 0x43, 0x3b, 0xe1, 0xf7, 0x53, 0xa2, 0xad, 0x21, 0xfc,
//		  0xda, 0x33, 0x64, 0xba, 0xa4, 0x4b, 0xe3, 0xbd, 0x23, 0x84, 0x59, 0x02,
//		  0x41, 0x00, 0xf8, 0xa0, 0x11, 0x7e, 0x04, 0xff, 0xbf, 0x6f, 0xeb, 0x3c,
//		  0x20, 0x13, 0x99, 0x5a, 0x64, 0xc9, 0xfb, 0xe8, 0xe3, 0x03, 0xe8, 0xc9,
//		  0x81, 0x85, 0x60, 0x4a, 0x10, 0x92, 0xf2, 0x70, 0x25, 0x7d, 0x35, 0xa1,
//		  0x5a, 0x95, 0xab, 0x41, 0x50, 0x77, 0x1e, 0xcf, 0x12, 0x5c, 0xee, 0xde,
//		  0x05, 0x07, 0x48, 0x2f, 0xef, 0x03, 0x95, 0xa3, 0x2f, 0x71, 0xd4, 0xb2,
//		  0xad, 0xfc, 0x64, 0x2c, 0xbd, 0xf3, 0x02, 0x41, 0x00, 0xe0, 0xd1, 0xa1,
//		  0x3c, 0x23, 0x75, 0x85, 0xbc, 0xa3, 0x95, 0x29, 0xc4, 0xe2, 0x2e, 0xc0,
//		  0x4b, 0xe5, 0x39, 0x34, 0xa1, 0xd6, 0x6e, 0x61, 0xc2, 0x87, 0xb7, 0x87,
//		  0x4b, 0x00, 0x22, 0x0c, 0x76, 0x76, 0x5c, 0x7e, 0x74, 0x18, 0xe8, 0xc9,
//		  0xc2, 0x36, 0x15, 0x83, 0x9d, 0xf4, 0x1c, 0xce, 0x9e, 0xa1, 0xd4, 0x02,
//		  0xa6, 0x86, 0x6f, 0x5f, 0x65, 0x3a, 0xa8, 0xad, 0x4c, 0x31, 0x30, 0x06,
//		  0xf5, 0x02, 0x41, 0x00, 0xcb, 0xbd, 0x18, 0x38, 0x85, 0xce, 0x32, 0x49,
//		  0x7b, 0xa2, 0x4c, 0xc2, 0xe2, 0xd3, 0x51, 0x6e, 0xb7, 0xd1, 0x33, 0x5f,
//		  0x3b, 0xbf, 0x0d, 0x35, 0x88, 0x1f, 0x89, 0x8f, 0x71, 0xbe, 0x76, 0xea,
//		  0x31, 0x2d, 0xa5, 0x76, 0xaa, 0xdd, 0x1e, 0x1c, 0x4f, 0x91, 0xef, 0x01,
//		  0x5a, 0xf9, 0x73, 0x73, 0x71, 0x33, 0x5e, 0x91, 0x38, 0x69, 0x7e, 0x72,
//		  0xb0, 0x93, 0x2f, 0xc2, 0x79, 0x30, 0xb5, 0x03, 0x02, 0x40, 0x68, 0x4e,
//		  0x1a, 0x26, 0x52, 0xb5, 0x45, 0xd5, 0x1d, 0x78, 0x29, 0x26, 0xe5, 0x61,
//		  0x97, 0x6a, 0x1e, 0xf1, 0x89, 0x8f, 0xc4, 0x72, 0xf5, 0xfc, 0x51, 0x07,
//		  0x3f, 0x47, 0xf6, 0xc9, 0xd5, 0x4a, 0x68, 0xe3, 0xc4, 0xef, 0x8c, 0x57,
//		  0x04, 0xb4, 0x8c, 0x6f, 0x32, 0xdf, 0x67, 0xd0, 0xad, 0xb4, 0x3f, 0x94,
//		  0xa3, 0x9e, 0x2b, 0x25, 0x24, 0xf7, 0x4c, 0x5d, 0xd1, 0xf9, 0x55, 0xa0,
//		  0xd8, 0xb9, 0x02, 0x40, 0x04, 0x74, 0x6f, 0x1a, 0xa7, 0x2f, 0x6c, 0x40,
//		  0x98, 0x92, 0xb8, 0x3e, 0x91, 0xec, 0xd7, 0x84, 0x14, 0xbe, 0xe8, 0x87,
//		  0xaa, 0x05, 0x30, 0x71, 0x2e, 0xee, 0x04, 0x0d, 0xce, 0xe2, 0xdd, 0x97,
//		  0xfd, 0x90, 0x48, 0x54, 0xbd, 0x6f, 0x04, 0x60, 0x1e, 0x92, 0x2c, 0xfc,
//		  0x79, 0x5b, 0x19, 0x21, 0x79, 0x94, 0x56, 0x29, 0xf2, 0xc9, 0xac, 0x46,
//		  0xe2, 0x8d, 0x81, 0x05, 0xe0, 0x23, 0x76, 0x66
//		};

/*
 * GLOBAL FUNCTIONS DEFINITIONS
 ****************************************************************************************
 */

// Dzung: moved to app_func.c
void am0_app_start_advertising(void)
{
    uint8_t name_len;

    // Prepare the GAPM_START_ADVERTISE_CMD message
    struct gapm_start_advertise_cmd *cmd = KE_MSG_ALLOC(GAPM_START_ADVERTISE_CMD,
            TASK_GAPM, TASK_APP,
            gapm_start_advertise_cmd);

    cmd->op.code        = GAPM_ADV_UNDIRECT;
    cmd->op.addr_src    = GAPM_GEN_RSLV_ADDR;
    cmd->channel_map    = ADV_ALL_CHNLS_EN;

    cmd->intv_min = AM0_ADV_INT_MIN;
    cmd->intv_max = AM0_ADV_INT_MAX;
    cmd->info.host.mode = GAP_GEN_DISCOVERABLE;

    /*-----------------------------------------------------------------------------------
     * Set the Advertising Data and the Scan Response Data
     *---------------------------------------------------------------------------------*/
    // Flag value is set by the GAP

    cmd->info.host.adv_filt_policy    = ADV_ALLOW_SCAN_ANY_CON_ANY;

    // service uuid in adv data
    memcpy(&(cmd->info.host.adv_data[2]), HAS_HEARING_AID_SERVICE_UUID, 16);
    cmd->info.host.adv_data[0]  = 17;
    cmd->info.host.adv_data[1]  = 0x07;
    cmd->info.host.adv_data_len = 18;

    // Name in scan response
    /* Dzung: appm_get_dev_name() in
     * C:\Repository\swt_components\vendor\ceva\rw-ble-sw\src\modules\app\src\app.c
    */
//    Dzung: name_len = appm_get_dev_name(&(cmd->info.host.scan_rsp_data[2]));
    cmd->info.host.scan_rsp_data[0]  = name_len+1;
    cmd->info.host.scan_rsp_data[1]  = 0x08;
    cmd->info.host.scan_rsp_data_len = name_len+2;


    // Send the message
    ke_msg_send(cmd);

    {
        // set non-pairable mode or non pairable mode according to pairing status
        struct am0_has_set_pairable_mode_cmd *pairable = KE_MSG_ALLOC(AM0_HAS_SET_PAIRABLE_MODE_CMD,
                                                                      am0_app_env.prf_task, TASK_APP,
                                                                      am0_has_set_pairable_mode_cmd);

        /* Dzung: app_sec_get_bond_status() in
         * C:\Repository\swt_components\vendor\ceva\rw-ble-sw\src\modules\app\src\app_sec.c
         */
//        Dzung: pairable->mode = app_sec_get_bond_status() ? AM0_MODE_NON_PAIRABLE_MODE : AM0_MODE_PAIRABLE_MODE;
        ke_msg_send(pairable);
    }

    #if (DISPLAY_SUPPORT)
    am0_app_env.state  = AM0_APP_STATE_OFF;
    am0_app_env.volume = 0;
    app_display_update_audio_info(am0_app_env.state, am0_app_env.volume);
    #endif // (DISPLAY_SUPPORT)
}


void am0_app_set_prf_task(uint16_t task)
{
    am0_app_env.prf_task = task;
}


void am0_app_init(void)
{
//    #if (NVDS_SUPPORT)
    uint8_t cert_len;
    uint8_t cursor;
    uint8_t status;

//    // retrieve identifier
//    am0_app_env.id_len = NVDS_LEN_AM0_ID;
//    if (nvds_get(NVDS_TAG_AM0_ID, &(am0_app_env.id_len), am0_app_env.id) != NVDS_OK)
//    {
        memcpy(am0_app_env.id, AM0_APP_DFLT_ID, sizeof(AM0_APP_DFLT_ID));
        am0_app_env.id_len = sizeof(AM0_APP_DFLT_ID);
//    }

    // retrieve other identifier
//    am0_app_env.other_id_len = NVDS_LEN_AM0_ID;
//    if (nvds_get(NVDS_TAG_AM0_OTHER_ID, &(am0_app_env.other_id_len), am0_app_env.other_id) != NVDS_OK)
//    {
        memcpy(am0_app_env.other_id, AM0_APP_DFLT_OTHER_ID, sizeof(AM0_APP_DFLT_OTHER_ID));
        am0_app_env.other_id_len = sizeof(AM0_APP_DFLT_OTHER_ID);
        ASSERT_ERR(0);
//    }

    // retrieve private key
//    cursor = NVDS_TAG_AM0_PRIV_KEY_FIRST;
//    am0_app_env.cert_priv_key_len = 0;
//    do
//    {
//        cert_len = NVDS_LEN_AM0_PRIV_KEY;
//        // retrieve NVDS Data
//        status = nvds_get(cursor, &(cert_len), &(am0_app_env.cert_priv_key[am0_app_env.cert_priv_key_len]));
//
//        // ensure that no error occurs during certificate loading
//        if(status != NVDS_OK)
//        {
//            ASSERT_INFO(0, status, cursor);
//        }
//
//        // Increment cursor
//        am0_app_env.cert_priv_key_len += cert_len;
//        cursor++;
//
//    } while((cert_len == NVDS_LEN_AM0_PRIV_KEY) && (cursor <= NVDS_TAG_AM0_PRIV_KEY_LAST));

    // Dzung: hard-code the private key (composed of five 64-byte private sub-keys)
    am0_app_env.cert_priv_key_len = AM0_CERT_PRIV_KEY_LEN;
    memcpy(am0_app_env.cert_priv_key, AM0_CERT_PRIV_KEY, AM0_CERT_PRIV_KEY_LEN);

    // retrieve certificate
//    cursor = NVDS_TAG_AM0_CERT_FIRST;
//    am0_app_env.cert_data_len = 0;
//    do
//    {
//        cert_len = NVDS_LEN_AM0_CERT;
//        // retrieve NVDS Data
//        status = nvds_get(cursor, &(cert_len), &(am0_app_env.cert_data[am0_app_env.cert_data_len]));
//
//        // ensure that no error occurs during certificate loading
//        if(status != NVDS_OK)
//        {
//            ASSERT_INFO(0, status, cursor);
//        }
//
//        // Increment cursor
//        am0_app_env.cert_data_len += cert_len;
//        cursor++;
//
//    } while((cert_len == NVDS_LEN_AM0_CERT) && (cursor <= NVDS_TAG_AM0_CERT_LAST));

    // Dzung: hard-code the certificate data
    am0_app_env.cert_data_len = AM0_CERT_DATA_LEN;
    memcpy(am0_app_env.cert_data, AM0_CERT_DATA, AM0_CERT_DATA_LEN);


    for(cursor = 0 ; cursor < AM0_NB_PROGS ; cursor++)
    {
        am0_app_env.progs[cursor].category = AM0_CAT_DEFAULT;
        am0_app_env.progs[cursor].name_len = sizeof(AM0_APP_PROG_DFLT_NAME);
        memcpy(am0_app_env.progs[cursor].name, AM0_APP_PROG_DFLT_NAME, sizeof(AM0_APP_PROG_DFLT_NAME));
    }
    am0_app_env.selected_prog_id = 0;
    am0_app_env.active_prog_id   = 0;

//    #else
//    ASSERT_ERR(0);
//    #endif // (NVDS_SUPPORT)
}


void am0_app_add_has(void)
{
    struct am0_has_db_cfg* db_cfg;
    struct gapm_profile_task_add_cmd *req = KE_MSG_ALLOC_DYN(GAPM_PROFILE_TASK_ADD_CMD,
                                                  TASK_GAPM, TASK_APP,
                                                  gapm_profile_task_add_cmd, sizeof(struct am0_has_db_cfg));
    // Fill message
    req->operation = GAPM_PROFILE_TASK_ADD;
    req->sec_lvl = PERM(SVC_AUTH, ENABLE);
    req->prf_task_id = TASK_ID_AM0_HAS;
    req->app_task = TASK_APP;
    req->start_hdl = 0;

    // Set parameters
    db_cfg = (struct am0_has_db_cfg* ) req->param;

    // Available programs version
    db_cfg->ava_progs_version = 1;
    // Left or Right ear (@see enum am0_ear)
    db_cfg->ear               = AM0_EAR_LEFT;
    // Audio Mixing support (@see enum am0_audio_mix)
    db_cfg->audio_mix_support = AM0_MIX_NOT_SUPPORTED;
    // Microphone volume (range [0:255] 0 = mute)
    db_cfg->mic_volume        = 150;
    // 2nd Stream volume (range [0:255] 0 = mute)
    db_cfg->sec_stream_volume = 100;
    // Active program identifier
    db_cfg->active_prog_id    = am0_app_env.active_prog_id;
    // Current Battery Level (range [0:10])
    db_cfg->batt_lvl          = 10;

    // Send the message
    ke_msg_send(req);
}

void am0_app_restore_bond_data(uint8_t conidx)
{
    // nothing to do
}



void am0_app_send_audio_init(uint8_t conidx)
{
    struct am0_stream_ctrl_cmd* init = KE_MSG_ALLOC_DYN(AM0_STREAM_CTRL_CMD,
                                                        KE_BUILD_ID(TASK_AM0, conidx), APP_MAIN_TASK,
                                                        am0_stream_ctrl_cmd, 1);

    init->operation = AM0_OP_AUDIO_INIT;
    init->param.init.capabilities = AM0_CAP_AUDIO_OUT_SUP;

    init->param.init.nb_codec     = 1;

    //Dzung: AM0 application
    //set supportable codec(s)
    //notes: related details to be verified in am0_codec_sel_req_ind_handler()
    //to ensure codec(s) specified here is supported

    /// ITU-T G.722 (64kbps), 40B => conn interval = 2.5ms
    init->param.init.codecs[0]       = AM0_CODEC_ITU_T_G_722;
    init->param.init.max_pkt_size    = 40;

    /// ITU-T G.726 (32kbps), 60B => conn interval = 7.5ms
//    init->param.init.codecs[0]       = AM0_CODEC_ITU_T_G_726;
//    init->param.init.max_pkt_size    = 60;

    /// ITU-T G.711 (64 kbps), 40B => conn interval = 2.5ms
//    init->param.init.codecs[0]       = AM0_CODEC_ITU_T_G_711;
//    init->param.init.max_pkt_size    = 40;

    ke_msg_send(init);

    #if (DISPLAY_SUPPORT)
    am0_app_env.state  = AM0_APP_STATE_INIT;
    app_display_update_audio_info(am0_app_env.state, am0_app_env.volume);
    #endif // (DISPLAY_SUPPORT)
}


/*
 * TASK FUNCTIONS HANDLER
 ****************************************************************************************
 */

/**
 ****************************************************************************************
 * @brief handles end of command
 *
 * @param[in] msgid     Id of the message received.
 * @param[in] param     Pointer to the parameters of the message.
 * @param[in] dest_id   ID of the receiving task instance (TASK_GAP).
 * @param[in] src_id    ID of the sending task instance.
 *
 * @return If the message was consumed or not.
 ****************************************************************************************
 */
//static
int am0_cmp_evt_handler(ke_msg_id_t const msgid,
		                struct am0_cmp_evt *param,
		                ke_task_id_t const dest_id,
		                ke_task_id_t const src_id)
{
    // nothing to do


    return KE_MSG_CONSUMED;
}

/**
 ****************************************************************************************
 * @brief Handles confirmation of Audio mode connection accepted by peer device
 *
 * @param[in] msgid     Id of the message received.
 * @param[in] param     Pointer to the parameters of the message.
 * @param[in] dest_id   ID of the receiving task instance (TASK_GAP).
 * @param[in] src_id    ID of the sending task instance.
 *
 * @return If the message was consumed or not.
 ****************************************************************************************
 */
//static
int am0_device_connect_ind_handler(ke_msg_id_t const msgid,
                                          struct am0_device_connect_ind *param,
                                          ke_task_id_t const dest_id,
                                          ke_task_id_t const src_id)
{
    #if (DISPLAY_SUPPORT)
    am0_app_env.state  = AM0_APP_STATE_CONNECTED;
    app_display_update_audio_info(am0_app_env.state, am0_app_env.volume);
    #endif // (DISPLAY_SUPPORT)

    return KE_MSG_CONSUMED;
}

/**
 ****************************************************************************************
 * @brief received the Device has selected codec, confirm codec selection
 *
 * @param[in] msgid     Id of the message received.
 * @param[in] param     Pointer to the parameters of the message.
 * @param[in] dest_id   ID of the receiving task instance (TASK_GAP).
 * @param[in] src_id    ID of the sending task instance.
 *
 * @return If the message was consumed or not.
 ****************************************************************************************
 */
//static
int am0_codec_sel_req_ind_handler(ke_msg_id_t const msgid,
                                         struct am0_codec_sel_req_ind *param,
                                         ke_task_id_t const dest_id,
                                         ke_task_id_t const src_id)
{
    struct am0_codec_sel_cfm* cfm = KE_MSG_ALLOC(AM0_CODEC_SEL_CFM, src_id, dest_id, am0_codec_sel_cfm);


    //Dung: AM0 application
    //various codecs could be used (instead of AM0_CODEC_ITU_T_G_711 only)
    switch (param->codec_id)
    {
    /// ITU-T G.722 (64kbps), 40B => conn interval = 2.5ms
    case AM0_CODEC_ITU_T_G_722:
    	cfm->accept       = true;
    	cfm->delay        = 0;
    	cfm->tx_size      = 0;
    	cfm->rx_size      = 40;
    	cfm->audio_cfg    = AM0_CFG_SYNC_P_GEN_EN;
    	cfm->mute_pattern = 0x00;
    	break;
    /// ITU-T G.726 (32kbps), 60B => conn interval = 7.5ms
    case AM0_CODEC_ITU_T_G_726:
    	cfm->accept       = true;
    	cfm->delay        = 0;
    	cfm->tx_size      = 0;
    	cfm->rx_size      = 60;
    	cfm->audio_cfg    = AM0_CFG_SYNC_P_GEN_EN;
    	cfm->mute_pattern = 0x00;
    	break;
    /// ITU-T G.711 (64 kbps), 40B => conn interval = 2.5ms
    case AM0_CODEC_ITU_T_G_711:
    	cfm->accept       = true;
    	cfm->delay        = 0;
    	cfm->tx_size      = 0;
    	cfm->rx_size      = 40;
    	cfm->audio_cfg    = AM0_CFG_SYNC_P_GEN_EN;
    	cfm->mute_pattern = 0x00;
        break;
    default:
    	cfm->accept = false;
    }

    ke_msg_send(cfm);

    return KE_MSG_CONSUMED;
}

/**
 ****************************************************************************************
 * @brief received the information that codec is ready
 *
 * @param[in] msgid     Id of the message received.
 * @param[in] param     Pointer to the parameters of the message.
 * @param[in] dest_id   ID of the receiving task instance (TASK_GAP).
 * @param[in] src_id    ID of the sending task instance.
 *
 * @return If the message was consumed or not.
 ****************************************************************************************
 */
//static
int am0_codec_ready_ind_handler(ke_msg_id_t const msgid,
                                       struct am0_codec_ready_ind *param,
                                       ke_task_id_t const dest_id,
                                       ke_task_id_t const src_id)
{
    #if (DISPLAY_SUPPORT)
    am0_app_env.state  = AM0_APP_STATE_CODEC_SEL;
    app_display_update_audio_info(am0_app_env.state, am0_app_env.volume);
    #endif // (DISPLAY_SUPPORT)

    return KE_MSG_CONSUMED;
}

/**
 ****************************************************************************************
 * @brief received the information that codec is ready
 *
 * @param[in] msgid     Id of the message received.
 * @param[in] param     Pointer to the parameters of the message.
 * @param[in] dest_id   ID of the receiving task instance (TASK_GAP).
 * @param[in] src_id    ID of the sending task instance.
 *
 * @return If the message was consumed or not.
 ****************************************************************************************
 */
//static
int am0_volume_ind_handler(ke_msg_id_t const msgid,
                                  struct am0_volume_ind *param,
                                  ke_task_id_t const dest_id,
                                  ke_task_id_t const src_id)
{
    #if (DISPLAY_SUPPORT)
    am0_app_env.volume  = param->volume;
    app_display_update_audio_info(am0_app_env.state, am0_app_env.volume);
    #endif // (DISPLAY_SUPPORT)

    return KE_MSG_CONSUMED;
}

/**
 ****************************************************************************************
 * @brief received the information that stream is started
 *
 * @param[in] msgid     Id of the message received.
 * @param[in] param     Pointer to the parameters of the message.
 * @param[in] dest_id   ID of the receiving task instance (TASK_GAP).
 * @param[in] src_id    ID of the sending task instance.
 *
 * @return If the message was consumed or not.
 ****************************************************************************************
 */
//static
int am0_stream_start_ind_handler(ke_msg_id_t const msgid,
                                        struct am0_stream_start_ind *param,
                                        ke_task_id_t const dest_id,
                                        ke_task_id_t const src_id)
{
    #if (DISPLAY_SUPPORT)
    am0_app_env.state  = AM0_APP_STATE_STREAM_ON;
    app_display_update_audio_info(am0_app_env.state, am0_app_env.volume);
    #endif // (DISPLAY_SUPPORT)

    return KE_MSG_CONSUMED;
}

/**
 ****************************************************************************************
 * @brief received the information that stream is stopped
 *
 * @param[in] msgid     Id of the message received.
 * @param[in] param     Pointer to the parameters of the message.
 * @param[in] dest_id   ID of the receiving task instance (TASK_GAP).
 * @param[in] src_id    ID of the sending task instance.
 *
 * @return If the message was consumed or not.
 ****************************************************************************************
 */
//static
int am0_stream_stop_ind_handler(ke_msg_id_t const msgid,
                                       void *param,
                                       ke_task_id_t const dest_id,
                                       ke_task_id_t const src_id)
{
    #if (DISPLAY_SUPPORT)
    am0_app_env.state  = AM0_APP_STATE_STREAM_OFF;
    app_display_update_audio_info(am0_app_env.state, am0_app_env.volume);
    #endif // (DISPLAY_SUPPORT)

    // TODO change connection parameters

    return KE_MSG_CONSUMED;
}

/**
 ****************************************************************************************
 * @brief received a message from another device
 *
 * @param[in] msgid     Id of the message received.
 * @param[in] param     Pointer to the parameters of the message.
 * @param[in] dest_id   ID of the receiving task instance (TASK_GAP).
 * @param[in] src_id    ID of the sending task instance.
 *
 * @return If the message was consumed or not.
 ****************************************************************************************
 */
//static
int am0_msg_ind_handler(ke_msg_id_t const msgid,
                               struct am0_msg_ind *param,
                               ke_task_id_t const dest_id,
                               ke_task_id_t const src_id)
{
    // not used for the moment
    return KE_MSG_CONSUMED;
}

/**
 ****************************************************************************************
 * @brief Error received
 *
 * @param[in] msgid     Id of the message received.
 * @param[in] param     Pointer to the parameters of the message.
 * @param[in] dest_id   ID of the receiving task instance (TASK_GAP).
 * @param[in] src_id    ID of the sending task instance.
 *
 * @return If the message was consumed or not.
 ****************************************************************************************
 */
//static
int am0_error_ind_handler(ke_msg_id_t const msgid,
                                 struct am0_error_ind *param,
                                 ke_task_id_t const dest_id,
                                 ke_task_id_t const src_id)
{
    // error detected
    struct am0_stream_ctrl_cmd* restart = KE_MSG_ALLOC(AM0_STREAM_CTRL_CMD, src_id, dest_id, am0_stream_ctrl_cmd);

    restart->operation = AM0_OP_RESTART;

    ke_msg_send(restart);

    return KE_MSG_CONSUMED;
}

/**
 ****************************************************************************************
 * @brief Inform that audio protocol has been restarted
 *
 * @param[in] msgid     Id of the message received.
 * @param[in] param     Pointer to the parameters of the message.
 * @param[in] dest_id   ID of the receiving task instance (TASK_GAP).
 * @param[in] src_id    ID of the sending task instance.
 *
 * @return If the message was consumed or not.
 ****************************************************************************************
 */
//static
int am0_restart_ind_handler(ke_msg_id_t const msgid,
                                   void *param,
                                   ke_task_id_t const dest_id,
                                   ke_task_id_t const src_id)
{
    // restart audio protocol
    am0_app_send_audio_init(KE_IDX_GET(src_id));

    return KE_MSG_CONSUMED;
}



/**
 ****************************************************************************************
 * @brief Inform that has operation is completed
 *
 * @param[in] msgid     Id of the message received.
 * @param[in] param     Pointer to the parameters of the message.
 * @param[in] dest_id   ID of the receiving task instance (TASK_GAP).
 * @param[in] src_id    ID of the sending task instance.
 *
 * @return If the message was consumed or not.
 ****************************************************************************************
 */
//static
int am0_has_cmp_evt_handler(ke_msg_id_t const msgid,
                                   struct am0_has_cmp_evt *param,
                                   ke_task_id_t const dest_id,
                                   ke_task_id_t const src_id)
{
    // not used for the moment
    return KE_MSG_CONSUMED;
}

/**
 ****************************************************************************************
 * @brief Inform that notification configuration is updated
 *
 * @param[in] msgid     Id of the message received.
 * @param[in] param     Pointer to the parameters of the message.
 * @param[in] dest_id   ID of the receiving task instance (TASK_GAP).
 * @param[in] src_id    ID of the sending task instance.
 *
 * @return If the message was consumed or not.
 ****************************************************************************************
 */
//static
int am0_ntf_cfg_update_ind_handler(ke_msg_id_t const msgid,
                                          struct am0_ntf_cfg_update_ind *param,
                                          ke_task_id_t const dest_id,
                                          ke_task_id_t const src_id)
{
    // not used for the moment (always updated by peer device)
    return KE_MSG_CONSUMED;
}

/**
 ****************************************************************************************
 * @brief Inform that peer device requests a service information
 *
 * @param[in] msgid     Id of the message received.
 * @param[in] param     Pointer to the parameters of the message.
 * @param[in] dest_id   ID of the receiving task instance (TASK_GAP).
 * @param[in] src_id    ID of the sending task instance.
 *
 * @return If the message was consumed or not.
 ****************************************************************************************
 */
//static
int am0_has_read_val_req_ind_handler(ke_msg_id_t const msgid,
                                            struct am0_has_read_val_req_ind *param,
                                            ke_task_id_t const dest_id,
                                            ke_task_id_t const src_id)
{
    switch(param->value)
    {
        case AM0_HAS_IDENTIFIER:
        {
            struct am0_has_read_val_cfm *id_cfm = KE_MSG_ALLOC_DYN(AM0_HAS_READ_VAL_CFM, src_id, dest_id,
                                                                   am0_has_read_val_cfm, AM0_IDENTIFIER_MAX_LEN);
            id_cfm->value         = param->value;
            id_cfm->status        = GAP_ERR_NO_ERROR;
            id_cfm->res.array.len = am0_app_env.id_len;
            memcpy(id_cfm->res.array.data, am0_app_env.id, am0_app_env.id_len);

            ke_msg_send(id_cfm);
        }
        break;

        case AM0_HAS_OTHER_IDENTIFIER:
        {
            struct am0_has_read_val_cfm *other_id_cfm = KE_MSG_ALLOC_DYN(AM0_HAS_READ_VAL_CFM, src_id, dest_id,
                                                                         am0_has_read_val_cfm, AM0_IDENTIFIER_MAX_LEN);
            other_id_cfm->value         = param->value;
            other_id_cfm->status        = GAP_ERR_NO_ERROR;
            other_id_cfm->res.array.len = am0_app_env.other_id_len;
            memcpy(other_id_cfm->res.array.data, am0_app_env.other_id, am0_app_env.other_id_len);
            ke_msg_send(other_id_cfm);
        }
        break;

        case AM0_HAS_AVA_PROGS_BIT_MASK:
        {
            uint8_t array_len = (AM0_NB_PROGS+7)/8;
            uint8_t cursor;
            struct am0_has_read_val_cfm *ava_progs_cfm = KE_MSG_ALLOC_DYN(AM0_HAS_READ_VAL_CFM, src_id, dest_id,
                                                                          am0_has_read_val_cfm, array_len);
            ava_progs_cfm->value         = param->value;
            ava_progs_cfm->status        = GAP_ERR_NO_ERROR;
            ava_progs_cfm->res.array.len = array_len;

            for(cursor = 0 ; cursor < array_len; cursor++)
            {
                uint32_t value = ((1 << AM0_NB_PROGS)-1) >> (cursor*8);
                ava_progs_cfm->res.array.data[cursor] = value&0xFF;
            }

            ke_msg_send(ava_progs_cfm);
        }
        break;

        case AM0_HAS_SELECTED_PROG_ID:
        {
            struct am0_has_read_val_cfm *sel_prog = KE_MSG_ALLOC(AM0_HAS_READ_VAL_CFM, src_id, dest_id, am0_has_read_val_cfm);
            sel_prog->value         = param->value;
            sel_prog->status        = GAP_ERR_NO_ERROR;
            sel_prog->res.prog_id   = am0_app_env.selected_prog_id;
            ke_msg_send(sel_prog);
        }
        break;

        case AM0_HAS_SELECTED_PROG_NAME:
        {
            struct am0_has_read_val_cfm *sel_prog = KE_MSG_ALLOC_DYN(AM0_HAS_READ_VAL_CFM, src_id, dest_id, am0_has_read_val_cfm, AM0_PROG_NAME_MAX_LEN);
            sel_prog->value         = param->value;
            sel_prog->status        = GAP_ERR_NO_ERROR;
            sel_prog->res.array.len = am0_app_env.progs[am0_app_env.selected_prog_id].name_len;
            memcpy(sel_prog->res.array.data, am0_app_env.progs[am0_app_env.selected_prog_id].name, AM0_PROG_NAME_MAX_LEN);
            ke_msg_send(sel_prog);
        }
        break;


        case AM0_HAS_SELECTED_PROG_CAT:
        {
            struct am0_has_read_val_cfm *prog_cat = KE_MSG_ALLOC(AM0_HAS_READ_VAL_CFM, src_id, dest_id, am0_has_read_val_cfm);
            prog_cat->value         = param->value;
            prog_cat->status        = GAP_ERR_NO_ERROR;
            prog_cat->res.category  = am0_app_env.progs[am0_app_env.selected_prog_id].category;
            ke_msg_send(prog_cat);
        }
        break;

        default:
        {
            ASSERT_INFO(0, param->value, src_id);
        } break;
    }

    return KE_MSG_CONSUMED;
}


/**
 ****************************************************************************************
 * @brief Inform that peer device update a service information
 *
 * @param[in] msgid     Id of the message received.
 * @param[in] param     Pointer to the parameters of the message.
 * @param[in] dest_id   ID of the receiving task instance (TASK_GAP).
 * @param[in] src_id    ID of the sending task instance.
 *
 * @return If the message was consumed or not.
 ****************************************************************************************
 */
//static
int am0_has_write_val_req_ind_handler(ke_msg_id_t const msgid,
                                             struct am0_has_write_val_req_ind *param,
                                             ke_task_id_t const dest_id,
                                             ke_task_id_t const src_id)
{
    uint8_t status = GAP_ERR_NO_ERROR;
    switch(param->value)
    {
        case AM0_HAS_SELECTED_PROG_NAME:
        {
            if(param->req.array.len <= AM0_PROG_NAME_MAX_LEN)
            {
                memcpy(am0_app_env.progs[am0_app_env.selected_prog_id].name, param->req.array.data, param->req.array.len);
                am0_app_env.progs[am0_app_env.selected_prog_id].name_len = param->req.array.len;
            }
            else
            {
                status = ATT_ERR_APP_ERROR;
            }
        }
        break;
        case AM0_HAS_MIC_VOLUME:
        {
            // TODO modify display info
        }
        break;
        case AM0_HAS_2ND_STREAM_VOLUME:
        {
            // TODO  modify display info
        }
        break;
        case AM0_HAS_ACTIVE_PROG_ID:
        {
            if(param->req.prog_id < AM0_NB_PROGS)
            {
                am0_app_env.active_prog_id = param->req.prog_id;
            }
            else
            {
                status = ATT_ERR_APP_ERROR;
            }
        }
        break;
        case AM0_HAS_SELECTED_PROG_ID:
        {
            if(param->req.prog_id < AM0_NB_PROGS)
            {
                am0_app_env.selected_prog_id = param->req.prog_id;
            }
            else
            {
                status = ATT_ERR_APP_ERROR;
            }
        }
        break;
        case AM0_HAS_SELECTED_PROG_CAT:
        {
            am0_app_env.progs[am0_app_env.selected_prog_id].category = param->req.category;
        }
        break;

        default:
        {
            ASSERT_INFO(0, param->value, src_id);
        } break;
    }

    struct am0_has_write_val_cfm *cfm = KE_MSG_ALLOC(AM0_HAS_WRITE_VAL_CFM, src_id, dest_id, am0_has_write_val_cfm);
    cfm->value         = param->value;
    cfm->status        = status;
    ke_msg_send(cfm);

    return KE_MSG_CONSUMED;
}


/**
 ****************************************************************************************
 * @brief Inform that peer device requests an authentication information
 *
 * @param[in] msgid     Id of the message received.
 * @param[in] param     Pointer to the parameters of the message.
 * @param[in] dest_id   ID of the receiving task instance (TASK_GAP).
 * @param[in] src_id    ID of the sending task instance.
 *
 * @return If the message was consumed or not.
 ****************************************************************************************
 */
//static
int am0_has_get_auth_info_req_ind_handler(ke_msg_id_t const msgid,
                                             struct am0_has_get_auth_info_req_ind *param,
                                             ke_task_id_t const dest_id,
                                             ke_task_id_t const src_id)
{
   #if (DISPLAY_SUPPORT)
   am0_app_env.state  = AM0_APP_STATE_AUTH;
   app_display_update_audio_info(am0_app_env.state, am0_app_env.volume);
   #endif // (DISPLAY_SUPPORT)

    switch(param->info)
    {
        case AM0_AS_CERTIFICATE_PART_A:
        {
            uint16_t length = co_min(512, am0_app_env.cert_data_len);
            struct am0_has_get_auth_info_cfm *cfm_a = KE_MSG_ALLOC_DYN(AM0_HAS_GET_AUTH_INFO_CFM, src_id, dest_id,
                                                                       am0_has_get_auth_info_cfm, length);
            cfm_a->info      = param->info;
            cfm_a->status    = GAP_ERR_NO_ERROR;
            cfm_a->array.len = length;
            memcpy(cfm_a->array.data, &(am0_app_env.cert_data[0]), length);

            ke_msg_send(cfm_a);
        }
        break;

        case AM0_AS_CERTIFICATE_PART_B:
        {
            struct am0_has_get_auth_info_cfm *cfm_b;
            if(am0_app_env.cert_data_len >= 512)
            {
                uint16_t length = co_min(512, am0_app_env.cert_data_len-512);
                cfm_b = KE_MSG_ALLOC_DYN(AM0_HAS_GET_AUTH_INFO_CFM, src_id, dest_id, am0_has_get_auth_info_cfm, length);
                cfm_b->info      = param->info;
                cfm_b->status    = GAP_ERR_NO_ERROR;
                cfm_b->array.len = length;
                memcpy(cfm_b->array.data, &(am0_app_env.cert_data[512]), length);
            }
            else
            {
                cfm_b = KE_MSG_ALLOC(AM0_HAS_GET_AUTH_INFO_CFM, src_id, dest_id, am0_has_get_auth_info_cfm);
                cfm_b->info      = param->info;
                cfm_b->status    = ATT_ERR_APP_ERROR;
            }

            ke_msg_send(cfm_b);
        }
        break;

        case AM0_AS_PRIVATE_KEY:
        {
            struct am0_has_get_auth_info_cfm *cfm_p_key;
            cfm_p_key = KE_MSG_ALLOC_DYN(AM0_HAS_GET_AUTH_INFO_CFM, src_id, dest_id, am0_has_get_auth_info_cfm, am0_app_env.cert_priv_key_len);
            cfm_p_key->info      = param->info;
            cfm_p_key->status    = GAP_ERR_NO_ERROR;
            cfm_p_key->array.len = am0_app_env.cert_priv_key_len;
            memcpy(cfm_p_key->array.data, &(am0_app_env.cert_priv_key), am0_app_env.cert_priv_key_len);

            //stanley_CHALLENGE_RESP_2
            ke_msg_send(cfm_p_key);
        }
        break;

        default:
        {
            ASSERT_INFO(0, param->info, src_id);
        } break;
    }

    return KE_MSG_CONSUMED;
}


/// Default State handlers definition
// Dzung: moved to app_task.c
//const struct ke_msg_handler am0_app_msg_handler_list[] =
//{
//    // Command Complete event
//    {AM0_CMP_EVT,                   (ke_msg_func_t)am0_cmp_evt_handler},
//    // Inform that device is Audio Mode 0 Compliant
//    {AM0_DEVICE_CONNECT_IND,        (ke_msg_func_t)am0_device_connect_ind_handler},
//    // Inform that device select a specific codec
//    {AM0_CODEC_SEL_REQ_IND,         (ke_msg_func_t)am0_codec_sel_req_ind_handler},
//    // Inform that accessory codec is ready to be used
//    {AM0_CODEC_READY_IND,           (ke_msg_func_t)am0_codec_ready_ind_handler},
//    // Inform Accessory that Device want to update the volume.
//    {AM0_VOLUME_IND,                (ke_msg_func_t)am0_volume_ind_handler},
//    // Inform Accessory that Device want to start stream.
//    {AM0_STREAM_START_IND,          (ke_msg_func_t)am0_stream_start_ind_handler},
//    // Inform Accessory that Device want to stop stream.
//    {AM0_STREAM_STOP_IND,           (ke_msg_func_t)am0_stream_stop_ind_handler},
//    // Message received through device from another accessory
//    {AM0_MSG_IND,                   (ke_msg_func_t)am0_msg_ind_handler},
//    // Inform that peer device trigg an unexpected error
//    {AM0_ERROR_IND,                 (ke_msg_func_t)am0_error_ind_handler},
//    // Inform that Device or Accessory request to restart (Reset) audio connection.
//    {AM0_RESTART_IND,               (ke_msg_func_t)am0_restart_ind_handler},
//};

/// Default State handlers definition
// Dzung: moved to app_task.c
//const struct ke_msg_handler am0_app_has_msg_handler_list[] =
//{
//    // Command complete event
//    {AM0_HAS_CMP_EVT,               (ke_msg_func_t)am0_has_cmp_evt_handler},
//    // Inform application that notification for specific profile has been updated.
//    {AM0_NTF_CFG_UPDATE_IND,        (ke_msg_func_t)am0_ntf_cfg_update_ind_handler},
//    // Peer request a service value
//    {AM0_HAS_READ_VAL_REQ_IND,      (ke_msg_func_t)am0_has_read_val_req_ind_handler},
//    // Peer request to modify a service value
//    {AM0_HAS_WRITE_VAL_REQ_IND,     (ke_msg_func_t)am0_has_write_val_req_ind_handler},
//    // Peer request to modify a service value
//    {AM0_HAS_GET_AUTH_INFO_REQ_IND, (ke_msg_func_t)am0_has_get_auth_info_req_ind_handler},
//};


/// AM0 message table handler
//const struct ke_state_handler am0_app_table_handler =
//    {&am0_app_msg_handler_list[0],     (sizeof(am0_app_msg_handler_list)     / sizeof(struct ke_msg_handler))};

/// HAS message table handler
// Dzung: all handlers moved to app_task.c handler table, this table is no longer needed
//const struct ke_state_handler am0_app_has_table_handler =
//    {&am0_app_has_msg_handler_list[0], (sizeof(am0_app_has_msg_handler_list) / sizeof(struct ke_msg_handler))};

#endif // defined(BLE_APP_AM0)


/// @} app_am0
